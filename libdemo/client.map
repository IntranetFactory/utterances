{"version":3,"sources":["deparam.ts","client.ts"],"names":[],"mappings":"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","file":"client.map","sourceRoot":"..\\src","sourcesContent":["export function deparam(query: string): { [name: string]: string; } {\r\n  let match: RegExpExecArray | null;\r\n  const plus = /\\+/g;\r\n  const search = /([^&=]+)=?([^&]*)/g;\r\n  const decode = (s: string) => decodeURIComponent(s.replace(plus, ' '));\r\n  const params: { [name: string]: string; } = {};\r\n  // tslint:disable-next-line:no-conditional-assignment\r\n  while (match = search.exec(query)) {\r\n    params[decode(match[1])] = decode(match[2]);\r\n  }\r\n  return params;\r\n}\r\n\r\nexport function param(obj: any) {\r\n  const parts = [];\r\n  for (const name in obj) {\r\n    if (obj.hasOwnProperty(name)) {\r\n      parts.push(`${encodeURIComponent(name)}=${encodeURIComponent(obj[name])}`);\r\n    }\r\n  }\r\n  return parts.join('&');\r\n}\r\n","import { param } from './deparam';\r\nimport { ResizeMessage } from './bus';\r\n\r\nlet script = document.querySelector('#GitHubCommentScript') as HTMLScriptElement;\r\nif (!script) {\r\n  throw Error(\"GitHubCommentScript configuration element is required\");\r\n}\r\n\r\n// gather script element's attributes\r\nconst attrs: { [name: string]: string; } = {};\r\nfor (let i = 0; i < script.attributes.length; i++) {\r\n  const attribute = script.attributes.item(i);\r\n  attrs[attribute.name] = attribute.value;\r\n}\r\n\r\n// gather page attributes\r\nattrs.url = location.href;\r\nattrs.origin = location.origin;\r\nattrs.pathname = location.pathname.substr(1).replace(/\\.\\w+$/, '');\r\nattrs.title = document.title;\r\nconst descriptionMeta = document.querySelector(`meta[name='description']`) as HTMLMetaElement;\r\nattrs.description = descriptionMeta ? descriptionMeta.content : '';\r\n\r\n// create the standard utterances styles and insert them at the beginning of the\r\n// <head> for easy overriding.\r\n// NOTE: the craziness with \"width\" is for mobile safari :(\r\ndocument.head.insertAdjacentHTML(\r\n  'afterbegin',\r\n  `<style>\r\n    .utterances {\r\n      position: relative;\r\n      width: 100%;\r\n    }\r\n    .utterances-frame {\r\n      position: absolute;\r\n      left: 0;\r\n      right: 0;\r\n      width: 1px;\r\n      min-width: 100%;\r\n      max-width: 100%;\r\n      height: 100%;\r\n      border: 0;\r\n    }\r\n  </style>`);\r\n\r\n// create the comments iframe and it's responsive container\r\nconst url = attrs['resources-path'] + '/utterances.html';\r\nscript.insertAdjacentHTML(\r\n  'afterend',\r\n  `<div class=\"utterances\">\r\n    <iframe class=\"utterances-frame\" scrolling=\"no\" src=\"${url}?${param(attrs)}\"></iframe>\r\n  </div>`);\r\nconst container = script.nextElementSibling as HTMLDivElement;\r\nscript.parentElement!.removeChild(script);\r\n\r\n// adjust the iframe's height when the height of it's content changes\r\naddEventListener('message', event => {\r\n  const data = event.data as ResizeMessage;\r\n  if (data && data.type === 'resize' && data.height) {\r\n    container.style.height = `${data.height}px`;\r\n  }\r\n});\r\n"]}