{"version":3,"sources":["deparam.ts","repo-regex.ts","page-attributes.ts","oauth.ts","encoding.ts","github.ts","bus.ts","new-issue-component.ts","time-ago.ts","comment-component.ts","timeline-component.ts","new-comment-component.ts","issue-component.ts","feedback-component.ts","utterances.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAAA,OAAA,CAAwB,KAAxB,EAAqC;AACnC,MAAI,KAAJ;AACA,MAAM,IAAI,GAAG,KAAb;AACA,MAAM,MAAM,GAAG,oBAAf;;AACA,MAAM,MAAM,GAAG,SAAT,MAAS,CAAC,CAAD,EAAU;AAAK,WAAA,kBAAkB,CAAC,CAAC,CAAC,OAAF,CAAU,IAAV,EAAgB,GAAhB,CAAD,CAAlB;AAAwC,GAAtE;;AACA,MAAM,MAAM,GAAgC,EAA5C;;AAEA,SAAO,KAAK,GAAG,MAAM,CAAC,IAAP,CAAY,KAAZ,CAAf,EAAmC;AACjC,IAAA,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAD,CAAN,CAAP,CAAN,GAA2B,MAAM,CAAC,KAAK,CAAC,CAAD,CAAN,CAAjC;AACD;;AACD,SAAO,MAAP;AACD;;AAXD,OAAA,CAAA,OAAA,GAAA,OAAA;;AAaA,SAAA,KAAA,CAAsB,GAAtB,EAA8B;AAC5B,MAAM,KAAK,GAAG,EAAd;;AACA,OAAK,IAAM,IAAX,IAAmB,GAAnB,EAAwB;AACtB,QAAI,GAAG,CAAC,cAAJ,CAAmB,IAAnB,CAAJ,EAA8B;AAC5B,MAAA,KAAK,CAAC,IAAN,CAAc,kBAAkB,CAAC,IAAD,CAAlB,GAAwB,GAAxB,GAA4B,kBAAkB,CAAC,GAAG,CAAC,IAAD,CAAJ,CAA5D;AACD;AACF;;AACD,SAAO,KAAK,CAAC,IAAN,CAAW,GAAX,CAAP;AACD;;AARD,OAAA,CAAA,KAAA,GAAA,KAAA;;;;;;;ACbA,OAAA,CAAA,OAAA,GAAe,6BAAf;;;;;;;;;;;;;;ACAA,IAAA,SAAA,GAAA,OAAA,CAAA,WAAA,CAAA;;AACA,IAAA,YAAA,GAAA,eAAA,CAAA,OAAA,CAAA,cAAA,CAAA,CAAA;;AAEA,SAAA,kBAAA,GAAA;AACE,MAAM,MAAM,GAAG,SAAA,CAAA,OAAA,CAAQ,QAAQ,CAAC,MAAT,CAAgB,MAAhB,CAAuB,CAAvB,CAAR,CAAf;AAEA,MAAI,SAAS,GAAkB,IAA/B;AACA,MAAI,WAAW,GAAkB,IAAjC;;AACA,MAAI,gBAAgB,MAApB,EAA4B;AAC1B,IAAA,SAAS,GAAG,MAAM,CAAC,YAAD,CAAlB;;AACA,QAAI,SAAS,KAAK,SAAlB,EAA6B;AAC3B,UAAI,SAAS,KAAK,EAAlB,EAAsB;AACpB,cAAM,IAAI,KAAJ,CAAU,mDAAV,CAAN;AACD;;AACD,UAAI,CAAC,OAAD,EAAU,KAAV,EAAiB,UAAjB,EAA6B,OAA7B,CAAqC,SAArC,MAAoD,CAAC,CAAzD,EAA4D;AAC1D,QAAA,SAAS,GAAG,MAAM,CAAC,SAAD,CAAlB;AACD;AACF;AACF,GAVD,MAUO,IAAI,kBAAkB,MAAtB,EAA8B;AACnC,IAAA,WAAW,GAAG,CAAC,MAAM,CAAC,cAAD,CAArB;;AACA,QAAI,WAAW,CAAC,QAAZ,CAAqB,EAArB,MAA6B,MAAM,CAAC,cAAD,CAAvC,EAAyD;AACvD,YAAM,IAAI,KAAJ,CAAU,gCAA6B,MAAM,CAAC,cAAD,CAA7C,CAAN;AACD;AACF,GALM,MAKA;AACL,UAAM,IAAI,KAAJ,CAAU,mDAAV,CAAN;AACD;;AAED,MAAI,EAAE,UAAU,MAAZ,CAAJ,EAAyB;AACvB,UAAM,IAAI,KAAJ,CAAU,qBAAV,CAAN;AACD;;AAED,MAAI,EAAE,YAAY,MAAd,CAAJ,EAA2B;AACzB,UAAM,IAAI,KAAJ,CAAU,uBAAV,CAAN;AACD;;AAED,MAAI,EAAE,kBAAkB,MAApB,CAAJ,EAAiC;AAC/B,UAAM,IAAI,KAAJ,CAAU,6BAAV,CAAN;AACD;;AAED,MAAM,aAAa,GAAI,oBAAoB,MAArB,GAA+B,MAAM,CAAC,gBAAD,CAArC,GAA0D,EAAhF;AAEA,MAAM,OAAO,GAAG,YAAA,CAAA,OAAA,CAAU,IAAV,CAAe,MAAM,CAAC,IAAtB,CAAhB;;AACA,MAAI,OAAO,KAAK,IAAhB,EAAsB;AACpB,UAAM,IAAI,KAAJ,CAAU,qBAAkB,MAAM,CAAC,IAAzB,GAA6B,IAAvC,CAAN;AACD;;AAED,SAAO;AACL,IAAA,KAAK,EAAE,OAAO,CAAC,CAAD,CADT;AAEL,IAAA,IAAI,EAAE,OAAO,CAAC,CAAD,CAFR;AAGL,IAAA,MAAM,EAAE,YAAY,MAAZ,GAAqB,MAAM,CAAC,MAA5B,GAAqC,QAHxC;AAIL,IAAA,UAAU,EAAE,iBAAiB,MAAjB,GAA0B,MAAM,CAAC,aAAD,CAAhC,GAAkD,iBAJzD;AAKL,IAAA,SAAS,EAAA,SALJ;AAML,IAAA,WAAW,EAAA,WANN;AAOL,IAAA,MAAM,EAAE,MAAM,CAAC,MAPV;AAQL,IAAA,GAAG,EAAE,MAAM,CAAC,GARP;AASL,IAAA,KAAK,EAAE,MAAM,CAAC,KATT;AAUL,IAAA,WAAW,EAAE,MAAM,CAAC,WAVf;AAWL,IAAA,WAAW,EAAE,MAAM,CAAC,cAAD,CAXd;AAYL,IAAA,aAAa,EAAE;AAZV,GAAP;AAcD;;AAEY,OAAA,CAAA,cAAA,GAAiB,kBAAkB,EAAnC;;;;;;;;AC9Db,IAAA,SAAA,GAAA,OAAA,CAAA,WAAA,CAAA;;AACA,IAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AAEA,IAAM,YAAY,GAAM,iBAAA,CAAA,cAAA,CAAK,WAAL,GAAgB,YAAxC;AACA,IAAM,QAAQ,GAAM,iBAAA,CAAA,cAAA,CAAK,WAAL,GAAgB,QAApC;AAGA,IAAM,YAAY,GAAG,iBAAA,CAAA,cAAA,CAAK,aAAL,GAChB,QAAQ,CAAC,MAAT,GAAe,GAAf,GAAmB,iBAAA,CAAA,cAAA,CAAK,aAAxB,GAAqC,kBADrB,GAEhB,QAAQ,CAAC,MAAT,GAAe,kBAFpB;;AAIA,IAAA,KAAA,GAAA,YAAA;AAIE,WAAA,KAAA,GAAA;AAHiB,SAAA,UAAA,GAAa,cAAb;AACT,SAAA,KAAA,GAAuB,IAAvB;;AAGN,QAAI;AACF,WAAK,KAAL,GAAa,YAAY,CAAC,OAAb,CAAqB,KAAK,UAA1B,CAAb;AAED,KAHD,CAGE,OAAO,CAAP,EAAU,CAAG;AAChB;;AAED,EAAA,MAAA,CAAA,cAAA,CAAI,KAAA,CAAA,SAAJ,EAAI,OAAJ,EAAS;SAAT,eAAA;AACE,aAAO,KAAK,KAAZ;AACD,KAFQ;SAGT,aAAU,QAAV,EAAkB;AAChB,WAAK,KAAL,GAAa,QAAb;;AACA,UAAI;AACF,YAAI,QAAQ,KAAK,IAAjB,EAAuB;AACrB,UAAA,YAAY,CAAC,UAAb,CAAwB,KAAK,UAA7B;AACD,SAFD,MAEO;AACL,UAAA,YAAY,CAAC,OAAb,CAAqB,KAAK,UAA1B,EAAsC,QAAtC;AACD;AAEF,OAPD,CAOE,OAAO,CAAP,EAAU,CAAG;AAChB,KAbQ;oBAAA;;AAAA,GAAT;AAcF,SAAA,KAAA;AAzBA,CAAA,EAAA;;AA2Ba,OAAA,CAAA,KAAA,GAAQ,IAAI,KAAJ,EAAR;;AAEb,SAAA,KAAA,GAAA;AACE,EAAA,MAAM,CAAC,IAAP,CAAe,YAAY,GAAA,GAAZ,GAAgB,SAAA,CAAA,KAAA,CAAM;AAAE,IAAA,YAAY,EAAA;AAAd,GAAN,CAA/B;AACA,SAAO,IAAI,OAAJ,CAAY,UAAA,OAAA,EAAO;AAAI,WAAC,MAAc,CAAC,gBAAf,GAAkC,OAAnC;AAA0C,GAAjE,EACJ,IADI,CACC,UAAA,MAAA,EAAM;AAAI,WAAA,KAAK,CAAC,QAAQ,GAAG,MAAZ,EAAoB;AAAE,MAAA,IAAI,EAAE;AAAR,KAApB,CAAL;AAA0C,GADrD,EAEJ,IAFI,CAEC,UAAA,QAAA,EAAQ;AACZ,QAAI,QAAQ,CAAC,EAAb,EAAiB;AACf,aAAO,QAAQ,CAAC,IAAT,EAAP;AACD;;AACD,WAAO,QAAQ,CAAC,IAAT,GAAgB,IAAhB,CAAqB,UAAA,IAAA,EAAI;AAAI,aAAA,OAAO,CAAC,MAAR,CAAe,8BAA4B,IAA3C,CAAA;AAAkD,KAA/E,CAAP;AACD,GAPI,EAQJ,IARI,CAQC,UAAA,CAAA,EAAC;AAAM,IAAA,OAAA,CAAA,KAAA,CAAM,KAAN,GAAc,CAAd;AAAkB,GAR1B,EAQ4B,UAAA,MAAA,EAAM;AAAM,IAAA,OAAA,CAAA,KAAA,CAAM,KAAN,GAAc,IAAd;AAAoB,UAAM,MAAN;AAAe,GAR3E,CAAP;AASD;;AAXD,OAAA,CAAA,KAAA,GAAA,KAAA;;;;;;;;ACtCA,SAAA,gBAAA,CAAiC,OAAjC,EAAgD;AAC9C,EAAA,OAAO,GAAG,OAAO,CAAC,OAAR,CAAgB,KAAhB,EAAuB,EAAvB,CAAV;AACA,SAAO,kBAAkB,CAAC,MAAM,CAAC,IAAI,CAAC,OAAD,CAAL,CAAP,CAAzB;AACD;;AAHD,OAAA,CAAA,gBAAA,GAAA,gBAAA;;;;;;;;ACFA,IAAA,OAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AACA,IAAA,UAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AACA,IAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AAEA,IAAM,UAAU,GAAG,yBAAnB;AACA,IAAM,0BAA0B,GAAG,0CAAnC;AACA,IAAM,qBAAqB,GAAG,qCAA9B;AACA,IAAM,kCAAkC,GAAG,8CAA3C;AACA,IAAM,SAAS,GAAG,GAAlB;AAEA,IAAI,KAAJ;AACA,IAAI,IAAJ;AACA,IAAI,MAAJ;;AAEA,SAAA,cAAA,CAA+B,OAA/B,EAAwF;AACtF,EAAA,KAAK,GAAG,OAAO,CAAC,KAAhB;AACA,EAAA,IAAI,GAAG,OAAO,CAAC,IAAf;AACA,EAAA,MAAM,GAAG,OAAO,CAAC,MAAjB;AACD;;AAJD,OAAA,CAAA,cAAA,GAAA,cAAA;;AAMA,SAAA,aAAA,CAAuB,WAAvB,EAA4C,IAA5C,EAA8D;AAC5D,EAAA,IAAI,GAAG,IAAI,IAAI,EAAf;AACA,EAAA,IAAI,CAAC,IAAL,GAAY,MAAZ;AACA,EAAA,IAAI,CAAC,KAAL,GAAa,UAAb;AACA,MAAM,OAAO,GAAG,IAAI,OAAJ,CAAY,UAAU,GAAG,WAAzB,EAAsC,IAAtC,CAAhB;AACA,EAAA,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,QAApB,EAA8B,kCAA9B;;AACA,MAAI,CAAC,YAAY,IAAZ,CAAiB,WAAjB,CAAD,IAAkC,OAAA,CAAA,KAAA,CAAM,KAAN,KAAgB,IAAtD,EAA4D;AAC1D,IAAA,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,eAApB,EAAqC,WAAS,OAAA,CAAA,KAAA,CAAM,KAApD;AACD;;AACD,SAAO,OAAP;AACD;;AAED,IAAM,SAAS,GAAG;AAChB,EAAA,QAAQ,EAAE;AACR,IAAA,KAAK,EAAE,MAAM,CAAC,SADN;AAER,IAAA,SAAS,EAAE,MAAM,CAAC,SAFV;AAGR,IAAA,KAAK,EAAE;AAHC,GADM;AAMhB,EAAA,MAAM,EAAE;AACN,IAAA,KAAK,EAAE,MAAM,CAAC,SADR;AAEN,IAAA,SAAS,EAAE,MAAM,CAAC,SAFZ;AAGN,IAAA,KAAK,EAAE;AAHD;AANQ,CAAlB;;AAaA,SAAA,gBAAA,CAA0B,QAA1B,EAA4C;AAC1C,MAAM,KAAK,GAAG,QAAQ,CAAC,OAAT,CAAiB,GAAjB,CAAqB,mBAArB,CAAd;AACA,MAAM,SAAS,GAAG,QAAQ,CAAC,OAAT,CAAiB,GAAjB,CAAqB,uBAArB,CAAlB;AACA,MAAM,KAAK,GAAG,QAAQ,CAAC,OAAT,CAAiB,GAAjB,CAAqB,mBAArB,CAAd;AAEA,MAAM,QAAQ,GAAG,aAAa,IAAb,CAAkB,QAAQ,CAAC,GAA3B,CAAjB;AACA,MAAM,IAAI,GAAG,QAAQ,GAAG,SAAS,CAAC,MAAb,GAAsB,SAAS,CAAC,QAArD;AAEA,EAAA,IAAI,CAAC,KAAL,GAAa,CAAC,KAAd;AACA,EAAA,IAAI,CAAC,SAAL,GAAiB,CAAC,SAAlB;AACA,EAAA,IAAI,CAAC,KAAL,GAAa,CAAC,KAAd;;AAEA,MAAI,QAAQ,CAAC,MAAT,KAAoB,GAApB,IAA2B,IAAI,CAAC,SAAL,KAAmB,CAAlD,EAAqD;AACnD,QAAM,SAAS,GAAG,IAAI,IAAJ,CAAS,CAAT,CAAlB;AACA,IAAA,SAAS,CAAC,aAAV,CAAwB,IAAI,CAAC,KAA7B;AACA,QAAM,IAAI,GAAG,IAAI,CAAC,KAAL,CAAW,CAAC,SAAS,CAAC,OAAV,KAAsB,IAAI,IAAJ,GAAW,OAAX,EAAvB,IAA+C,IAA/C,GAAsD,EAAjE,CAAb;AACA,QAAM,OAAO,GAAG,QAAQ,GAAG,YAAH,GAAkB,iBAA1C;AAEA,IAAA,OAAO,CAAC,IAAR,CAAa,6BAA2B,OAA3B,GAAkC,cAAlC,GAAiD,IAAjD,GAAqD,SAArD,IAA+D,IAAI,KAAK,CAAT,GAAa,EAAb,GAAkB,GAAjF,IAAoF,GAAjG;AACD;AACF;;AAED,SAAA,WAAA,CAAqB,QAArB,EAAuC;AACrC,MAAM,IAAI,GAAG,QAAQ,CAAC,OAAT,CAAiB,GAAjB,CAAqB,MAArB,CAAb;;AACA,MAAI,IAAI,KAAK,IAAb,EAAmB;AACjB,WAAO,CAAP;AACD;;AACD,MAAM,KAAK,GAAG,oCAAoC,IAApC,CAAyC,IAAzC,CAAd;;AACA,MAAI,KAAK,KAAK,IAAd,EAAoB;AAClB,WAAO,CAAP;AACD;;AACD,SAAO,CAAC,KAAK,CAAC,CAAD,CAAb;AACD;;AAED,SAAA,WAAA,CAAqB,OAArB,EAAqC;AACnC,SAAO,KAAK,CAAC,OAAD,CAAL,CAAe,IAAf,CAAoB,UAAA,QAAA,EAAQ;AACjC,QAAI,QAAQ,CAAC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B,MAAA,OAAA,CAAA,KAAA,CAAM,KAAN,GAAc,IAAd;AACD;;AACD,QAAI,QAAQ,CAAC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B,MAAA,QAAQ,CAAC,IAAT,GAAgB,IAAhB,CAAqB,UAAA,IAAA,EAAI;AACvB,YAAI,IAAI,CAAC,OAAL,KAAiB,wCAArB,EAA+D;AAC7D,UAAA,MAAM,CAAC,aAAP,CAAqB,IAAI,WAAJ,CAAgB,eAAhB,CAArB;AACD;AACF,OAJD;AAKD;;AAED,IAAA,gBAAgB,CAAC,QAAD,CAAhB;;AAEA,QAAI,OAAO,CAAC,MAAR,KAAmB,KAAnB,IACC,CAAC,GAAD,EAAM,GAAN,EAAW,OAAX,CAAmB,QAAQ,CAAC,MAA5B,MAAwC,CAAC,CAD1C,IAEC,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,eAApB,CAFL,EAGE;AACA,MAAA,OAAO,CAAC,OAAR,CAAgB,MAAhB,CAAuB,eAAvB;AACA,aAAO,WAAW,CAAC,OAAD,CAAlB;AACD;;AACD,WAAO,QAAP;AACD,GAtBM,CAAP;AAuBD;;AAED,SAAA,YAAA,CAAgC,IAAhC,EAA8C,IAA9C,EAA0D;AAAZ,MAAA,IAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,IAAA,GAAA,KAAA;AAAY;;AACxD,MAAM,OAAO,GAAG,aAAa,CAAC,WAAS,KAAT,GAAc,GAAd,GAAkB,IAAlB,GAAsB,YAAtB,GAAmC,IAAnC,GAAuC,OAAvC,GAA+C,MAAhD,CAA7B;;AACA,MAAI,IAAJ,EAAU;AACR,IAAA,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,QAApB,EAA8B,qBAA9B;AACD;;AACD,SAAO,WAAW,CAAC,OAAD,CAAX,CAAqB,IAArB,CAAyD,UAAA,QAAA,EAAQ;AACtE,QAAI,QAAQ,CAAC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B,YAAM,IAAI,KAAJ,CAAU,YAAS,KAAT,GAAc,GAAd,GAAkB,IAAlB,GAAsB,kCAAtB,GAAuD,IAAvD,GAA2D,cAA3D,GAAwE,MAAxE,GAA8E,YAAxF,CAAN;AACD;;AACD,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,oBAAkB,IAAlB,GAAsB,GAAhC,CAAN;AACD;;AACD,WAAO,IAAI,GAAG,QAAQ,CAAC,IAAT,EAAH,GAAqB,QAAQ,CAAC,IAAT,EAAhC;AACD,GARM,EAQJ,IARI,CAQI,UAAA,IAAA,EAAI;AACb,QAAI,IAAJ,EAAU;AACR,aAAO,IAAP;AACD;;AACO,QAAA,OAAA,GAAA,IAAA,CAAA,OAAA;AACR,QAAM,OAAO,GAAG,UAAA,CAAA,gBAAA,CAAiB,OAAjB,CAAhB;AACA,WAAO,IAAI,CAAC,KAAL,CAAW,OAAX,CAAP;AACD,GAfM,CAAP;AAgBD;;AArBD,OAAA,CAAA,YAAA,GAAA,YAAA;;AAuBA,SAAA,gBAAA,CAAiC,IAAjC,EAA+C,IAA/C,EAA2D;AACzD,MAAM,CAAC,GAAM,IAAI,GAAA,yBAAJ,GAA8B,IAA9B,GAAkC,QAAlC,GAA2C,KAA3C,GAAgD,GAAhD,GAAoD,IAAjE;AACA,MAAM,OAAO,GAAG,aAAa,CAAC,qBAAmB,kBAAkB,CAAC,CAAD,CAArC,GAAwC,yBAAzC,CAA7B;AACA,SAAO,WAAW,CAAC,OAAD,CAAX,CAAqB,IAArB,CAA+C,UAAA,QAAA,EAAQ;AAC5D,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,mCAAV,CAAN;AACD;;AACD,WAAO,QAAQ,CAAC,IAAT,EAAP;AACD,GALM,EAKJ,IALI,CAKC,UAAA,OAAA,EAAO;AACb,QAAI,OAAO,CAAC,WAAR,KAAwB,CAA5B,EAA+B;AAC7B,aAAO,IAAP;AACD;;AACD,WAAO,OAAO,CAAC,KAAf;AACD,GAVM,CAAP;AAWD;;AAdD,OAAA,CAAA,gBAAA,GAAA,gBAAA;;AAgBA,SAAA,eAAA,CAAgC,IAAhC,EAA4C;AAC1C,MAAM,CAAC,GAAG,OAAI,IAAJ,GAAQ,4BAAR,GAAoC,KAApC,GAAyC,GAAzC,GAA6C,IAAvD;AACA,MAAM,OAAO,GAAG,aAAa,CAAC,qBAAmB,kBAAkB,CAAC,CAAD,CAArC,GAAwC,yBAAzC,CAA7B;AACA,SAAO,WAAW,CAAC,OAAD,CAAX,CAAqB,IAArB,CAA+C,UAAA,QAAA,EAAQ;AAC5D,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,kCAAV,CAAN;AACD;;AACD,WAAO,QAAQ,CAAC,IAAT,EAAP;AACD,GALM,EAKJ,IALI,CAKC,UAAA,OAAA,EAAO;AACb,QAAI,OAAO,CAAC,WAAR,KAAwB,CAA5B,EAA+B;AAC7B,aAAO,IAAP;AACD;;AACD,QAAI,OAAO,CAAC,WAAR,GAAsB,CAA1B,EAA6B;AAE3B,MAAA,OAAO,CAAC,IAAR,CAAa,6BAA0B,CAA1B,GAA2B,6BAAxC;AACD;;AACD,WAAO,OAAO,CAAC,KAAR,CAAc,CAAd,CAAP;AACD,GAdM,CAAP;AAeD;;AAlBD,OAAA,CAAA,eAAA,GAAA,eAAA;;AAoBA,SAAA,iBAAA,CAAkC,WAAlC,EAAqD;AACnD,MAAM,OAAO,GAAG,aAAa,CAAC,WAAS,KAAT,GAAc,GAAd,GAAkB,IAAlB,GAAsB,UAAtB,GAAiC,WAAlC,CAA7B;AACA,SAAO,WAAW,CAAC,OAAD,CAAX,CAAqB,IAArB,CAAiC,UAAA,QAAA,EAAQ;AAC9C,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,wCAAV,CAAN;AACD;;AACD,WAAO,QAAQ,CAAC,IAAT,EAAP;AACD,GALM,CAAP;AAMD;;AARD,OAAA,CAAA,iBAAA,GAAA,iBAAA;;AAUA,SAAA,eAAA,CAAyB,WAAzB,EAA8C,IAA9C,EAA4D,QAA5D,EAA6E;AAC3E,MAAI,SAAS,GAAG,QAAQ,GAAG,QAAH,GAAc,SAAtC;AACA,MAAM,GAAG,GAAG,WAAS,KAAT,GAAc,GAAd,GAAkB,IAAlB,GAAsB,UAAtB,GAAiC,WAAjC,GAA4C,iBAA5C,GAA8D,IAA9D,GAAkE,YAAlE,GAA+E,SAA3F;AACA,MAAM,OAAO,GAAG,aAAa,CAAC,GAAD,CAA7B;AACA,MAAM,MAAM,GAAM,0BAA0B,GAAA,GAA1B,GAA8B,kCAAhD;AACA,EAAA,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,QAApB,EAA8B,MAA9B;AACA,SAAO,OAAP;AACD;;AAED,SAAA,gBAAA,CAAiC,WAAjC,EAAsD,IAAtD,EAAkE;AAChE,MAAM,OAAO,GAAG,eAAe,CAAC,WAAD,EAAc,IAAd,CAA/B;AACA,SAAO,WAAW,CAAC,OAAD,CAAX,CAAqB,IAArB,CAA0B,UAAA,QAAA,EAAQ;AACvC,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,0BAAV,CAAN;AACD;;AACD,QAAM,QAAQ,GAAG,WAAW,CAAC,QAAD,CAA5B;AACA,WAAO,QAAQ,CAAC,IAAT,GACJ,IADI,CACe,UAAC,KAAD,EAAsB;AAAK,aAAC;AAAE,QAAA,KAAK,EAAA,KAAP;AAAS,QAAA,QAAQ,EAAA;AAAjB,OAAD;AAAqB,KAD/D,CAAP;AAED,GAPM,CAAP;AAQD;;AAVD,OAAA,CAAA,gBAAA,GAAA,gBAAA;;AAYA,SAAA,gBAAA,CAAiC,WAAjC,EAAoD;AAClD,MAAM,OAAO,GAAG,eAAe,CAAC,WAAD,EAAc,CAAd,EAAiB,CAAjB,CAA/B;AACA,SAAO,WAAW,CAAC,OAAD,CAAX,CAAqB,IAArB,CAA0B,UAAA,QAAA,EAAQ;AACvC,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,+BAAV,CAAN;AACD;;AACD,WAAO,QAAQ,CAAC,IAAT,GAAgB,IAAhB,CAAkC,UAAC,KAAD,EAAsB;AAAK,aAAA,KAAK,CAAC,MAAN,GAAe,KAAK,CAAC,CAAD,CAAL,CAAS,IAAxB,GAA+B,IAA/B;AAAmC,KAAhG,CAAP;AACD,GALM,CAAP;AAMD;;AARD,OAAA,CAAA,gBAAA,GAAA,gBAAA;;AAUA,SAAA,QAAA,GAAA;AACE,MAAI,OAAA,CAAA,KAAA,CAAM,KAAN,KAAgB,IAApB,EAA0B;AACxB,WAAO,OAAO,CAAC,OAAR,CAAgB,IAAhB,CAAP;AACD;;AACD,SAAO,WAAW,CAAC,aAAa,CAAC,MAAD,CAAd,CAAX,CACJ,IADI,CACC,UAAA,QAAA,EAAQ;AACZ,QAAI,QAAQ,CAAC,EAAb,EAAiB;AACf,aAAO,QAAQ,CAAC,IAAT,EAAP;AACD;;AACD,WAAO,IAAP;AACD,GANI,CAAP;AAOD;;AAXD,OAAA,CAAA,QAAA,GAAA,QAAA;;AAaA,SAAA,WAAA,CAA4B,SAA5B,EAA+C,WAA/C,EAAoE,KAApE,EAAmF,WAAnF,EAAwG,IAAxG,EAAkH;AAChH,MAAM,OAAO,GAAG,IAAI,OAAJ,CAAe,iBAAA,CAAA,cAAA,CAAK,WAAL,GAAgB,SAAhB,GAA0B,KAA1B,GAA+B,GAA/B,GAAmC,IAAnC,GAAuC,SAAtD,EAAiE;AAC/E,IAAA,MAAM,EAAE,MADuE;AAE/E,IAAA,IAAI,EAAE,IAAI,CAAC,SAAL,CAAe;AACnB,MAAA,KAAK,EAAE,SADY;AAEnB,MAAA,IAAI,EAAE,OAAK,KAAL,GAAU,MAAV,GAAiB,WAAjB,GAA4B,OAA5B,GAAoC,WAApC,GAA+C,IAA/C,GAAoD,WAApD,GAA+D,GAFlD;AAGnB,MAAA,SAAS,EAAE,CACT,IAAI,CAAC,KADI;AAHQ,KAAf;AAFyE,GAAjE,CAAhB;AAUA,EAAA,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,QAApB,EAA8B,kCAA9B;AACA,EAAA,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,eAApB,EAAqC,WAAS,OAAA,CAAA,KAAA,CAAM,KAApD;AACA,SAAO,KAAK,CAAC,OAAD,CAAL,CAAe,IAAf,CAA2B,UAAA,QAAA,EAAQ;AACxC,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,yCAAV,CAAN;AACD;;AACD,WAAO,QAAQ,CAAC,IAAT,EAAP;AACD,GALM,CAAP;AAMD;;AAnBD,OAAA,CAAA,WAAA,GAAA,WAAA;;AAqBA,SAAA,WAAA,CAA4B,WAA5B,EAAiD,QAAjD,EAAiE;AAC/D,MAAM,GAAG,GAAG,WAAS,KAAT,GAAc,GAAd,GAAkB,IAAlB,GAAsB,UAAtB,GAAiC,WAAjC,GAA4C,WAAxD;AACA,MAAM,IAAI,GAAG,IAAI,CAAC,SAAL,CAAe;AAAE,IAAA,IAAI,EAAE;AAAR,GAAf,CAAb;AACA,MAAM,OAAO,GAAG,aAAa,CAAC,GAAD,EAAM;AAAE,IAAA,MAAM,EAAE,MAAV;AAAkB,IAAA,IAAI,EAAA;AAAtB,GAAN,CAA7B;AACA,MAAM,MAAM,GAAM,0BAA0B,GAAA,GAA1B,GAA8B,kCAAhD;AACA,EAAA,OAAO,CAAC,OAAR,CAAgB,GAAhB,CAAoB,QAApB,EAA8B,MAA9B;AACA,SAAO,WAAW,CAAC,OAAD,CAAX,CAAqB,IAArB,CAAwC,UAAA,QAAA,EAAQ;AACrD,QAAI,CAAC,QAAQ,CAAC,EAAd,EAAkB;AAChB,YAAM,IAAI,KAAJ,CAAU,wBAAV,CAAN;AACD;;AACD,WAAO,QAAQ,CAAC,IAAT,EAAP;AACD,GALM,CAAP;AAMD;;AAZD,OAAA,CAAA,WAAA,GAAA,WAAA;;AAcA,SAAA,cAAA,CAA+B,IAA/B,EAA2C;AACzC,MAAM,IAAI,GAAG,IAAI,CAAC,SAAL,CAAe;AAAE,IAAA,IAAI,EAAA,IAAN;AAAQ,IAAA,IAAI,EAAE,KAAd;AAAqB,IAAA,OAAO,EAAK,KAAK,GAAA,GAAL,GAAS;AAA1C,GAAf,CAAb;AACA,SAAO,WAAW,CAAC,aAAa,CAAC,UAAD,EAAa;AAAE,IAAA,MAAM,EAAE,MAAV;AAAkB,IAAA,IAAI,EAAA;AAAtB,GAAb,CAAd,CAAX,CACJ,IADI,CACC,UAAA,QAAA,EAAQ;AAAI,WAAA,QAAQ,CAAC,IAAT,EAAA;AAAe,GAD5B,CAAP;AAED;;AAJD,OAAA,CAAA,cAAA,GAAA,cAAA;;;;;;;ACxPA,IAAI,UAAJ;;AAEA,SAAA,aAAA,CAA8B,MAA9B,EAA4C;AAC1C,EAAA,UAAU,GAAG,MAAb;AACA,EAAA,gBAAgB,CAAC,QAAD,EAAW,aAAX,CAAhB;AACD;;AAHD,OAAA,CAAA,aAAA,GAAA,aAAA;AAKA,IAAI,UAAU,GAAG,CAAC,CAAlB;;AAEA,SAAA,aAAA,GAAA;AACE,MAAM,MAAM,GAAG,QAAQ,CAAC,IAAT,CAAc,YAA7B;;AACA,MAAI,MAAM,KAAK,UAAf,EAA2B;AACzB;AACD;;AACD,EAAA,UAAU,GAAG,MAAb;AACA,MAAM,OAAO,GAAkB;AAAE,IAAA,IAAI,EAAE,QAAR;AAAkB,IAAA,MAAM,EAAA;AAAxB,GAA/B;AACA,EAAA,MAAM,CAAC,WAAP,CAAmB,OAAnB,EAA4B,UAA5B;AACD;;AARD,OAAA,CAAA,aAAA,GAAA,aAAA;;;;;;;;ACdA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAIA,IAAM,eAAe,GAAG,gZAAxB;AAEA,IAAM,kBAAkB,GAAG,+BAA6B,IAAI,CAAC,eAAD,CAA5D;;AAEA,IAAA,iBAAA,GAAA,YAAA;AAeE,WAAA,iBAAA,CACU,IADV,EAEmB,MAFnB,EAEgF;AAFhF,QAAA,KAAA,GAAA,IAAA;;AACU,SAAA,IAAA,GAAA,IAAA;AACS,SAAA,MAAA,GAAA,MAAA;AAJX,SAAA,UAAA,GAAa,KAAb;;AAkFA,SAAA,WAAA,GAAc,YAAA;AACpB,MAAA,KAAI,CAAC,YAAL,CAAkB,QAAlB,GAA6B,QAAQ,IAAR,CAAa,KAAI,CAAC,QAAL,CAAc,KAA3B,CAA7B;;AACA,UAAI,KAAI,CAAC,QAAL,CAAc,YAAd,GAA6B,GAA7B,IAAoC,KAAI,CAAC,QAAL,CAAc,YAAd,GAA6B,KAAI,CAAC,QAAL,CAAc,YAAnF,EAAiG;AAC/F,QAAA,KAAI,CAAC,QAAL,CAAc,KAAd,CAAoB,MAApB,GAAgC,KAAI,CAAC,QAAL,CAAc,YAAd,GAA0B,IAA1D;AACA,QAAA,KAAA,CAAA,aAAA;AACD;AACF,KANO;;AAQA,SAAA,YAAA,GAAe,UAAC,KAAD,EAAa;AAClC,MAAA,KAAK,CAAC,cAAN;;AACA,UAAI,KAAI,CAAC,UAAT,EAAqB;AACnB;AACD;;AACD,MAAA,KAAI,CAAC,UAAL,GAAkB,IAAlB;;AACA,UAAI,KAAI,CAAC,IAAT,EAAe;AACb,QAAA,KAAI,CAAC,QAAL,CAAc,QAAd,GAAyB,IAAzB;AACA,QAAA,KAAI,CAAC,YAAL,CAAkB,QAAlB,GAA6B,IAA7B;AACD;;AACD,MAAA,KAAI,CAAC,MAAL,CAAY,KAAI,CAAC,KAAL,CAAW,KAAvB,EAA8B,KAAI,CAAC,QAAL,CAAc,KAA5C,EAAmD,KAAnD,CAAyD,YAAA;AAAM,eAAA,CAAA;AAAC,OAAhE,EAAkE,IAAlE,CAAuE,YAAA;AACrE,QAAA,KAAI,CAAC,UAAL,GAAkB,KAAlB;AACA,QAAA,KAAI,CAAC,QAAL,CAAc,QAAd,GAAyB,CAAC,KAAI,CAAC,IAA/B;AACA,QAAA,KAAI,CAAC,QAAL,CAAc,KAAd,GAAsB,EAAtB;AACA,QAAA,KAAI,CAAC,YAAL,CAAkB,QAAlB,GAA6B,KAA7B;AACD,OALD;AAMD,KAhBO;;AApFN,SAAK,OAAL,GAAe,QAAQ,CAAC,aAAT,CAAuB,SAAvB,CAAf;AACA,SAAK,OAAL,CAAa,gBAAb,CAA8B,WAA9B,EAA2C,KAAA,CAAA,aAA3C;AAEA,SAAK,OAAL,CAAa,SAAb,GAAyB,0wCAAzB;AA0BA,SAAK,YAAL,GAAoB,KAAK,OAAL,CAAa,aAAb,CAA2B,SAA3B,CAApB;AACA,SAAK,MAAL,GAAc,KAAK,YAAL,CAAkB,iBAAhC;AACA,SAAK,IAAL,GAAY,KAAK,YAAL,CAAkB,kBAA9B;AACA,SAAK,KAAL,GAAa,KAAK,IAAL,CAAW,iBAAX,CAA8B,kBAA9B,CAAkD,iBAA/D;AACA,SAAK,QAAL,GAAgB,KAAK,KAAL,CAAY,kBAA5B;AACA,SAAK,YAAL,GAAoB,KAAK,IAAL,CAAW,gBAAX,CAA6B,gBAAjD;AAEA,SAAK,uBAAL,GAA+B,KAAK,OAAL,CAAa,aAAb,CAA2B,0BAA3B,CAA/B;AACA,SAAK,yBAAL,GAAiC,KAAK,OAAL,CAAa,aAAb,CAA2B,4BAA3B,CAAjC;AAEA,SAAK,yBAAL,CAA+B,gBAA/B,CAAgD,OAAhD,EAAyD,YAAA;AACvD,MAAA,KAAI,CAAC,yBAAL,CAA+B,YAA/B,CAA4C,QAA5C,EAAsD,EAAtD;;AACA,MAAA,KAAI,CAAC,uBAAL,CAA6B,eAA7B,CAA6C,QAA7C;AACD,KAHD;AAKA,SAAK,OAAL,CAAa,IAAb;AAEA,SAAK,QAAL,CAAc,gBAAd,CAA+B,OAA/B,EAAwC,KAAK,WAA7C;AACA,SAAK,IAAL,CAAU,gBAAV,CAA2B,QAA3B,EAAqC,KAAK,YAA1C;AACD;;AAEM,EAAA,iBAAA,CAAA,SAAA,CAAA,qBAAA,GAAP,YAAA;AACE,SAAK,yBAAL,CAA+B,eAA/B,CAA+C,QAA/C;AACA,SAAK,uBAAL,CAA6B,YAA7B,CAA0C,QAA1C,EAAoD,EAApD;AACD,GAHM;;AAKA,EAAA,iBAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,IAAf,EAAgC;AAC9B,SAAK,IAAL,GAAY,IAAZ;AACA,SAAK,YAAL,CAAkB,WAAlB,GAAgC,IAAI,GAAG,gBAAH,GAAsB,oBAA1D;AACA,SAAK,YAAL,CAAkB,QAAlB,GAA6B,CAAC,CAAC,IAA/B;;AAEA,QAAI,IAAJ,EAAU;AACR,WAAK,YAAL,CAAkB,IAAlB,GAAyB,IAAI,CAAC,QAA9B;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,MAAM,IAAI,CAAC,KAA7B;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,IAAI,CAAC,UAAL,GAAkB,WAApC;AACD,KAJD,MAIO;AACL,WAAK,YAAL,CAAkB,eAAlB,CAAkC,MAAlC;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,YAAlB;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,kBAAlB;AACD;AACF,GAdM;;AAgBA,EAAA,iBAAA,CAAA,SAAA,CAAA,KAAA,GAAP,YAAA;AACE,SAAK,QAAL,CAAc,KAAd,GAAsB,EAAtB;AACA,SAAK,KAAL,CAAW,KAAX,GAAmB,EAAnB;AACD,GAHM;;AA8BT,SAAA,iBAAA;AAxHA,CAAA,EAAA;;AAAa,OAAA,CAAA,iBAAA,GAAA,iBAAA;;;;;;;ACNb,IAAM,UAAU,GAAG,CACjB,IADiB,EACX,QADW,EAEjB,OAAO,EAFU,EAEN,QAFM,EAGjB,OAAO,EAAP,GAAY,EAHK,EAGD,MAHC,EAIjB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAJA,EAII,KAJJ,EAKjB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,CALL,EAKQ,MALR,EAMjB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,EANL,EAMS,OANT,CAAnB;AASA,IAAM,aAAa,GAA+B;AAAE,EAAA,KAAK,EAAE,OAAT;AAAkB,EAAA,GAAG,EAAE,SAAvB;AAAkC,EAAA,IAAI,EAAE;AAAxC,CAAlD;;AAEA,SAAA,OAAA,CAAwB,OAAxB,EAAyC,KAAzC,EAAoD;AAClD,MAAM,OAAO,GAAG,OAAO,GAAG,KAAK,CAAC,OAAN,EAA1B;;AACA,MAAI,OAAO,GAAG,IAAd,EAAoB;AAClB,WAAO,UAAP;AACD;;AACD,MAAI,CAAC,GAAG,CAAR;;AACA,SAAO,CAAC,GAAG,CAAJ,GAAQ,UAAU,CAAC,MAAnB,IAA6B,OAAO,GAAG,GAAV,GAAgB,UAAU,CAAC,CAAC,GAAG,CAAL,CAA9D,EAAuE;AACrE,IAAA,CAAC,IAAI,CAAL;AACD;;AAED,MAAM,OAAO,GAAG,UAAU,CAAC,CAAD,CAA1B;AACA,MAAM,IAAI,GAAG,UAAU,CAAC,CAAC,GAAG,CAAL,CAAvB;AACA,MAAM,KAAK,GAAG,IAAI,CAAC,KAAL,CAAW,OAAO,GAAG,OAArB,CAAd;;AAEA,MAAI,KAAK,GAAG,CAAR,IAAa,CAAC,KAAK,UAAU,CAAC,MAAX,GAAoB,CAA3C,EAA8C;AAC5C,WAAO,QAAM,KAAK,CAAC,kBAAN,CAAyB,SAAzB,EAAoC,aAApC,CAAb;AACD;;AACD,SAAO,KAAK,KAAK,CAAV,GAAc,CAAG,IAAI,KAAK,MAAT,GAAkB,IAAlB,GAAyB,GAA5B,IAA+B,GAA/B,GAAmC,IAAnC,GAAuC,MAArD,GAAiE,KAAK,GAAA,GAAL,GAAS,IAAT,GAAa,OAArF;AACD;;AAlBD,OAAA,CAAA,OAAA,GAAA,OAAA;;;;;;;;ACZA,IAAA,UAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AAEA,IAAM,UAAU,GAAG,WAAnB;AACA,IAAM,mBAAmB,GAAuC;AAC9D,EAAA,YAAY,EAAE,cADgD;AAE9D,EAAA,WAAW,EAAE,aAFiD;AAG9D,EAAA,MAAM,EAAE,QAHsD;AAI9D,EAAA,KAAK,EAAE;AAJuD,CAAhE;;AAOA,IAAA,gBAAA,GAAA,YAAA;AAGE,WAAA,gBAAA,CACS,OADT,EAEU,WAFV,EAEoC;AAD3B,SAAA,OAAA,GAAA,OAAA;AACC,SAAA,WAAA,GAAA,WAAA;AAEA,QAAA,IAAA,GAAA,OAAA,CAAA,IAAA;AAAA,QAAM,QAAA,GAAA,OAAA,CAAA,QAAN;AAAA,QAAgB,UAAA,GAAA,OAAA,CAAA,UAAhB;AAAA,QAA4B,SAAA,GAAA,OAAA,CAAA,SAA5B;AAAA,QAAuC,kBAAA,GAAA,OAAA,CAAA,kBAAvC;AACR,SAAK,OAAL,GAAe,QAAQ,CAAC,aAAT,CAAuB,SAAvB,CAAf;AACA,SAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,kBAA3B;;AACA,QAAI,IAAI,CAAC,KAAL,KAAe,WAAnB,EAAgC;AAC9B,WAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,cAA3B;AACD;;AACD,QAAM,WAAW,GAAG,mBAAmB,CAAC,kBAAD,CAAvC;AACA,SAAK,OAAL,CAAa,SAAb,GAAyB,wCACG,IAAI,CAAC,QADR,GACgB,6DADhB,GAER,IAAI,CAAC,KAFG,GAEE,qDAFF,GAGR,IAAI,CAAC,UAHG,GAGU,UAHV,GAGoB,gLAHpB,GAQY,IAAI,CAAC,QARjB,GAQyB,+BARzB,GAQsD,IAAI,CAAC,KAR3D,GAQgE,kFARhE,GAUY,QAVZ,GAUoB,uBAVpB,GAUyC,UAAA,CAAA,OAAA,CAAQ,IAAI,CAAC,GAAL,EAAR,EAAoB,IAAI,IAAJ,CAAS,UAAT,CAApB,CAVzC,GAUkF,qCAVlF,IAYjB,WAAW,GAAG,8CAA0C,WAA1C,GAAqD,SAAxD,GAAoE,EAZ9D,IAYgE,iGAZhE,GAejB,SAfiB,GAeR,gCAfjB;AAmBA,SAAK,aAAL;AACD;;AAEM,EAAA,gBAAA,CAAA,SAAA,CAAA,cAAA,GAAP,UAAsB,WAAtB,EAAgD;AAC9C,QAAI,KAAK,WAAL,KAAqB,WAAzB,EAAsC;AACpC;AACD;;AACD,SAAK,WAAL,GAAmB,WAAnB;;AAEA,QAAI,KAAK,OAAL,CAAa,IAAb,CAAkB,KAAlB,KAA4B,KAAK,WAArC,EAAkD;AAChD,WAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,cAA3B;AACD,KAFD,MAEO;AACL,WAAK,OAAL,CAAa,SAAb,CAAuB,MAAvB,CAA8B,cAA9B;AACD;AACF,GAXM;;AAaC,EAAA,gBAAA,CAAA,SAAA,CAAA,aAAA,GAAR,YAAA;AACE,QAAM,KAAK,GAAG,KAAK,OAAL,CAAa,gBAAb,CAA+B,gBAA/B,CAAiD,gBAAjD,CAAkE,GAAlE,CAAd;AACA,QAAI,CAAC,GAAG,KAAK,CAAC,MAAd;;AACA,WAAO,CAAC,EAAR,EAAY;AACV,UAAM,IAAI,GAAG,KAAK,CAAC,IAAN,CAAW,CAAX,CAAb;AACA,MAAA,IAAI,CAAC,MAAL,GAAc,QAAd;AACD;AACF,GAPO;;AAQV,SAAA,gBAAA;AAzDA,CAAA,EAAA;;AAAa,OAAA,CAAA,gBAAA,GAAA,gBAAA;;;;;;;;ACVb,IAAA,mBAAA,GAAA,OAAA,CAAA,qBAAA,CAAA;;AACA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAEA,IAAA,iBAAA,GAAA,YAAA;AAKE,WAAA,iBAAA,CACU,IADV,EAC2B;AAAjB,SAAA,IAAA,GAAA,IAAA;AAJO,SAAA,QAAA,GAA+B,EAA/B;AAMf,SAAK,OAAL,GAAe,QAAQ,CAAC,aAAT,CAAuB,SAAvB,CAAf;AACA,SAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,UAA3B;AACA,SAAK,MAAL,GAAc,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAd;AACA,SAAK,OAAL,CAAa,WAAb,CAAyB,KAAK,MAA9B;AACD;;AAEM,EAAA,iBAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,IAAf,EAAgC;AAC9B,SAAK,IAAL,GAAY,IAAZ;AACA,QAAM,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC,KAAR,GAAgB,IAAlC;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,QAAL,CAAc,MAAlC,EAA0C,CAAC,EAA3C,EAA+C;AAC7C,WAAK,QAAL,CAAc,CAAd,EAAiB,cAAjB,CAAgC,KAAhC;AACD;;AACD,IAAA,KAAA,CAAA,aAAA;AACD,GAPM;;AASA,EAAA,iBAAA,CAAA,SAAA,CAAA,aAAA,GAAP,UAAqB,OAArB,EAA0C;AACxC,QAAM,SAAS,GAAG,IAAI,mBAAA,CAAA,gBAAJ,CAChB,OADgB,EAEhB,KAAK,IAAL,GAAY,KAAK,IAAL,CAAU,KAAtB,GAA8B,IAFd,CAAlB;AAGA,SAAK,QAAL,CAAc,IAAd,CAAmB,SAAnB;AACA,SAAK,OAAL,CAAa,YAAb,CAA0B,SAAS,CAAC,OAApC,EAA6C,KAAK,MAAlD;AACA,IAAA,KAAA,CAAA,aAAA;AACD,GAPM;;AAQT,SAAA,iBAAA;AA/BA,CAAA,EAAA;;AAAa,OAAA,CAAA,iBAAA,GAAA,iBAAA;;;;;;;;ACJb,IAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AACA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAGA,IAAM,eAAe,GAAG,gZAAxB;AAEA,IAAM,kBAAkB,GAAG,+BAA6B,IAAI,CAAC,eAAD,CAA5D;AAEA,IAAM,gBAAgB,GAAG,oBAAzB;;AAEA,IAAA,mBAAA,GAAA,YAAA;AAaE,WAAA,mBAAA,CACU,IADV,EAEmB,MAFnB,EAE8D;AAF9D,QAAA,KAAA,GAAA,IAAA;;AACU,SAAA,IAAA,GAAA,IAAA;AACS,SAAA,MAAA,GAAA,MAAA;AALX,SAAA,UAAA,GAAa,KAAb;AACA,SAAA,aAAA,GAAgB,CAAhB;;AA4EA,SAAA,WAAA,GAAc,YAAA;AACpB,UAAM,IAAI,GAAG,KAAI,CAAC,QAAL,CAAc,KAA3B;AACA,UAAM,YAAY,GAAG,QAAQ,IAAR,CAAa,IAAb,CAArB;AACA,MAAA,KAAI,CAAC,YAAL,CAAkB,QAAlB,GAA6B,YAA7B;;AACA,UAAI,KAAI,CAAC,QAAL,CAAc,YAAd,GAA6B,GAA7B,IAAoC,KAAI,CAAC,QAAL,CAAc,YAAd,GAA6B,KAAI,CAAC,QAAL,CAAc,YAAnF,EAAiG;AAC/F,QAAA,KAAI,CAAC,QAAL,CAAc,KAAd,CAAoB,MAApB,GAAgC,KAAI,CAAC,QAAL,CAAc,YAAd,GAA0B,IAA1D;AACA,QAAA,KAAA,CAAA,aAAA;AACD;;AAED,MAAA,YAAY,CAAC,KAAI,CAAC,aAAN,CAAZ;;AACA,UAAI,YAAJ,EAAkB;AAChB,QAAA,KAAI,CAAC,OAAL,CAAa,WAAb,GAA2B,gBAA3B;AACD,OAFD,MAEO;AACL,QAAA,KAAI,CAAC,OAAL,CAAa,WAAb,GAA2B,oBAA3B;AACA,QAAA,KAAI,CAAC,aAAL,GAAqB,UAAU,CAC7B,YAAA;AAAM,iBAAA,QAAA,CAAA,cAAA,CAAe,IAAf,EAAqB,IAArB,CAA0B,UAAA,IAAA,EAAI;AAAI,mBAAA,KAAI,CAAC,OAAL,CAAa,SAAb,GAAyB,IAAzB;AAA6B,WAA/D,EAAiE,IAAjE,CAAsE,KAAA,CAAA,aAAtE,CAAA;AAAoF,SAD7D,EAE7B,GAF6B,CAA/B;AAGD;AACF,KAlBO;;AAoBA,SAAA,YAAA,GAAe,UAAC,KAAD,EAAa;AAClC,MAAA,KAAK,CAAC,cAAN;;AACA,UAAI,KAAI,CAAC,UAAT,EAAqB;AACnB;AACD;;AACD,MAAA,KAAI,CAAC,UAAL,GAAkB,IAAlB;;AACA,UAAI,KAAI,CAAC,IAAT,EAAe;AACb,QAAA,KAAI,CAAC,YAAL,CAAkB,QAAlB,GAA6B,IAA7B;AACD;;AACD,MAAA,KAAI,CAAC,MAAL,CAAY,KAAI,CAAC,QAAL,CAAc,KAA1B,EAAiC,KAAjC,CAAuC,YAAA;AAAM,eAAA,CAAA;AAAC,OAA9C,EAAgD,IAAhD,CAAqD,YAAA;AACnD,QAAA,KAAI,CAAC,UAAL,GAAkB,KAAlB;AACA,QAAA,KAAI,CAAC,QAAL,CAAc,KAAd,GAAsB,EAAtB;AACA,QAAA,KAAI,CAAC,YAAL,CAAkB,QAAlB,GAA6B,KAA7B;;AACA,QAAA,KAAI,CAAC,WAAL,CAAiB;AAAE,UAAA,MAAM,EAAE,KAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,uBAAxB;AAAV,SAAjB;;AACA,QAAA,KAAI,CAAC,OAAL,CAAa,WAAb,GAA2B,gBAA3B;AACD,OAND;AAOD,KAhBO;;AAkBA,SAAA,WAAA,GAAc,UAAC,EAAD,EAAkB;UAAf,MAAA,GAAA,EAAA,CAAA;;AACvB,UAAI,EAAE,MAAM,YAAY,iBAApB,KAA0C,CAAC,MAAM,CAAC,SAAP,CAAiB,QAAjB,CAA0B,YAA1B,CAA/C,EAAwF;AACtF;AACD;;AACD,UAAI,MAAM,CAAC,SAAP,CAAiB,QAAjB,CAA0B,UAA1B,CAAJ,EAA2C;AACzC;AACD;;AACD,MAAA,KAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,sBAAxB,EAAiD,SAAjD,CAA2D,MAA3D,CAAkE,UAAlE;;AACA,MAAA,MAAM,CAAC,SAAP,CAAiB,GAAjB,CAAqB,UAArB;AACA,UAAM,SAAS,GAAG,MAAM,CAAC,SAAP,CAAiB,QAAjB,CAA0B,aAA1B,CAAlB;AACA,MAAA,KAAI,CAAC,QAAL,CAAc,KAAd,CAAoB,OAApB,GAA8B,SAAS,GAAG,MAAH,GAAY,EAAnD;AACA,MAAA,KAAI,CAAC,OAAL,CAAa,KAAb,CAAmB,OAAnB,GAA6B,SAAS,GAAG,EAAH,GAAQ,MAA9C;AACA,MAAA,KAAA,CAAA,aAAA;AACD,KAbO;;AA5GN,SAAK,OAAL,GAAe,QAAQ,CAAC,aAAT,CAAuB,SAAvB,CAAf;AACA,SAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,kBAA3B;AACA,SAAK,OAAL,CAAa,gBAAb,CAA8B,WAA9B,EAA2C,KAAA,CAAA,aAA3C;AAEA,SAAK,OAAL,CAAa,SAAb,GAAyB,42BAoBf,gBApBe,GAoBC,uaApB1B;AAgCA,SAAK,YAAL,GAAoB,KAAK,OAAL,CAAa,iBAAjC;AACA,SAAK,MAAL,GAAc,KAAK,YAAL,CAAkB,iBAAhC;AACA,SAAK,IAAL,GAAY,KAAK,YAAL,CAAkB,kBAA9B;AACA,SAAK,QAAL,GAAgB,KAAK,IAAL,CAAW,iBAAX,CAA8B,kBAA9B,CAAkD,iBAAlE;AACA,SAAK,OAAL,GAAe,KAAK,IAAL,CAAW,iBAAX,CAA8B,kBAA9B,CAAkD,gBAAjE;AACA,SAAK,YAAL,GAAoB,KAAK,IAAL,CAAW,gBAAX,CAA6B,gBAAjD;AAEA,SAAK,OAAL,CAAa,IAAb;AAEA,SAAK,QAAL,CAAc,gBAAd,CAA+B,OAA/B,EAAwC,KAAK,WAA7C;AACA,SAAK,IAAL,CAAU,gBAAV,CAA2B,QAA3B,EAAqC,KAAK,YAA1C;AACA,SAAK,IAAL,CAAU,gBAAV,CAA2B,OAA3B,EAAoC,KAAK,WAAzC;AACD;;AAEM,EAAA,mBAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,IAAf,EAAgC;AAC9B,SAAK,IAAL,GAAY,IAAZ;AACA,SAAK,YAAL,CAAkB,WAAlB,GAAgC,IAAI,GAAG,gBAAH,GAAsB,oBAA1D;AACA,SAAK,YAAL,CAAkB,QAAlB,GAA6B,CAAC,CAAC,IAA/B;;AAEA,QAAI,IAAJ,EAAU;AACR,WAAK,YAAL,CAAkB,IAAlB,GAAyB,IAAI,CAAC,QAA9B;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,MAAM,IAAI,CAAC,KAA7B;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,IAAI,CAAC,UAAL,GAAkB,WAApC;AACD,KAJD,MAIO;AACL,WAAK,YAAL,CAAkB,eAAlB,CAAkC,MAAlC;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,YAAlB;AACA,WAAK,MAAL,CAAY,GAAZ,GAAkB,kBAAlB;AACD;AACF,GAdM;;AAgBA,EAAA,mBAAA,CAAA,SAAA,CAAA,KAAA,GAAP,YAAA;AACE,SAAK,QAAL,CAAc,KAAd,GAAsB,EAAtB;AACD,GAFM;;AAwDT,SAAA,mBAAA;AA3IA,CAAA,EAAA;;AAAa,OAAA,CAAA,mBAAA,GAAA,mBAAA;;;;;;;;ACVb,IAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AACA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AACA,IAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AAGA,IAAA,OAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AACA,IAAA,oBAAA,GAAA,OAAA,CAAA,sBAAA,CAAA;;AACA,IAAA,uBAAA,GAAA,OAAA,CAAA,yBAAA,CAAA;;AAIA,IAAA,cAAA,GAAA,YAAA;AAQE,WAAA,cAAA,CAAY,KAAZ,EAA0B,IAA1B,EAA2C;AAA3C,QAAA,KAAA,GAAA,IAAA;;AACE,QAAI,YAAY,GAAG,KAAK,YAAL,GAAoB,KAAK,CAAC,QAA7C;AACA,QAAI,GAAG,GAAG,MAAM,CAAC,QAAD,CAAN,CAAiB,KAAK,CAAC,UAAvB,EAAmC,OAAnC,EAAV;AACA,SAAK,OAAL,GAAe,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAf;AACA,SAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,SAA3B;AACA,SAAK,OAAL,CAAa,SAAb,GAAyB,oNAIqC,KAAK,CAAC,KAJ3C,GAIgD,6GAJhD,GAK0D,KAAK,CAAC,QALhE,GAKwE,4zCALxE,GAYQ,YAZR,GAYoB,6CAZ7C;AAiBA,QAAM,UAAU,GAAG,KAAK,UAAL,GAAkB,KAAK,OAAL,CAAa,aAAb,CAA2B,cAA3B,CAArC;AACA,QAAM,SAAS,GAAG,KAAK,SAAL,GAAiB,KAAK,OAAL,CAAa,aAAb,CAA2B,aAA3B,CAAnC;AACA,QAAM,qBAAqB,GAAG,KAAK,OAAL,CAAa,aAAb,CAA2B,0BAA3B,CAA9B;AACA,QAAM,eAAe,GAAG,KAAK,OAAL,CAAa,aAAb,CAA2B,aAA3B,CAAxB;AACA,QAAM,cAAc,GAAG,KAAK,OAAL,CAAa,aAAb,CAA2B,mBAA3B,CAAvB;AACA,QAAM,YAAY,GAAG,KAAK,OAAL,CAAa,aAAb,CAA2B,eAA3B,CAArB;;AAEA,QAAM,YAAY,GAAG,SAAf,YAAe,GAAA;AACnB,UAAI,MAAM,GAAG,UAAU,CAAC,YAAX,CAAwB,QAAxB,CAAb;;AACA,UAAI,MAAJ,EAAY;AACV,QAAA,UAAU,CAAC,eAAX,CAA2B,QAA3B;AACA,QAAA,SAAS,CAAC,YAAV,CAAuB,QAAvB,EAAiC,EAAjC;AACA,QAAA,QAAQ,CAAC,OAAT,CAAiB,YAAjB,CAA8B,QAA9B,EAAwC,EAAxC;AACA,QAAA,mBAAmB,CAAC,OAApB,CAA4B,YAA5B,CAAyC,QAAzC,EAAmD,EAAnD;AACA,QAAA,YAAY,CAAC,YAAb,CAA0B,QAA1B,EAAoC,EAApC;AAED,OAPD,MAOO;AACL,QAAA,UAAU,CAAC,YAAX,CAAwB,QAAxB,EAAkC,EAAlC;AACA,QAAA,SAAS,CAAC,eAAV,CAA0B,QAA1B;AACA,QAAA,QAAQ,CAAC,OAAT,CAAiB,eAAjB,CAAiC,QAAjC;AACA,QAAA,mBAAmB,CAAC,OAApB,CAA4B,eAA5B,CAA4C,QAA5C;AACA,QAAA,YAAY,CAAC,eAAb,CAA6B,QAA7B;AACD;;AAED,MAAA,KAAA,CAAA,aAAA;AACD,KAlBD;;AAoBA,IAAA,UAAU,CAAC,gBAAX,CAA4B,OAA5B,EAAqC,YAArC;AACA,IAAA,SAAS,CAAC,gBAAV,CAA2B,OAA3B,EAAoC,YAApC;AAEA,IAAA,qBAAqB,CAAC,gBAAtB,CAAuC,OAAvC,EAAgD,YAAhD;AACA,IAAA,cAAc,CAAC,gBAAf,CAAgC,OAAhC,EAAyC,YAAzC;;AAEA,QAAI,KAAK,IAAI,KAAK,CAAC,QAAN,GAAiB,CAA9B,EAAiC;AAC/B,MAAA,QAAA,CAAA,gBAAA,CAAiB,KAAK,CAAC,MAAvB,EAA+B,CAA/B,EAAkC,IAAlC,CAAuC,UAAA,YAAA,EAAY;AACjD,QAAA,YAAY,CAAC,KAAb,CAAmB,OAAnB,CAA2B,UAAA,IAAA,EAAI;AAC7B,UAAA,QAAQ,CAAC,aAAT,CAAuB,IAAvB;AACD,SAFD;AAGD,OAJD;AAKD;;AACD,QAAM,QAAQ,GAAG,KAAK,iBAAL,GAAyB,IAAI,oBAAA,CAAA,iBAAJ,CAAsB,IAAtB,CAA1C;AACA,IAAA,QAAQ,CAAC,OAAT,CAAiB,YAAjB,CAA8B,QAA9B,EAAwC,EAAxC;AACA,SAAK,OAAL,CAAa,WAAb,CAAyB,KAAK,iBAAL,CAAuB,OAAhD;;AAEA,QAAM,MAAM,GAAG,SAAT,MAAS,CAAC,QAAD,EAAiB;AAC9B,UAAI,IAAJ,EAAU;AACR,YAAI,cAAc,GAAA,KAAA,CAAlB;;AACA,YAAI,KAAJ,EAAW;AACT,UAAA,cAAc,GAAG,QAAA,CAAA,WAAA,CAAY,KAAK,CAAC,MAAlB,EAA0B,QAA1B,CAAjB;AACD,SAFD,MAEO;AACL,UAAA,cAAc,GAAG,QAAA,CAAA,WAAA,CACf,iBAAA,CAAA,cAAA,CAAK,SADU,EAEf,iBAAA,CAAA,cAAA,CAAK,GAFU,EAGf,iBAAA,CAAA,cAAA,CAAK,KAHU,EAIf,iBAAA,CAAA,cAAA,CAAK,WAJU,EAKf,IALe,EAMf,IANe,CAMV,UAAA,QAAA,EAAQ;AACb,YAAA,KAAK,GAAG,QAAR;AACA,mBAAO,QAAA,CAAA,WAAA,CAAY,KAAK,CAAC,MAAlB,EAA0B,QAA1B,CAAP;AACD,WATgB,CAAjB;AAUD;;AACD,eAAO,cAAc,CAAC,IAAf,CAAoB,UAAA,OAAA,EAAO;AAChC,UAAA,QAAQ,CAAC,aAAT,CAAuB,OAAvB;AACA,YAAE,YAAF;AACA,UAAA,eAAgB,CAAC,WAAjB,GAA+B,YAAY,GAAG,EAA9C;AACA,UAAA,mBAAmB,CAAC,KAApB;AACD,SALM,CAAP;AAMD;;AAED,aAAO,OAAA,CAAA,KAAA,GAAQ,IAAR,CAAa,YAAA;AAAM,eAAA,QAAA,CAAA,QAAA,EAAA;AAAU,OAA7B,EAA+B,IAA/B,CAAoC,UAAA,CAAA,EAAC;AAC1C,QAAA,IAAI,GAAG,CAAP;AACA,QAAA,QAAQ,CAAC,OAAT,CAAiB,IAAjB;AACA,QAAA,mBAAmB,CAAC,OAApB,CAA4B,IAA5B;;AACA,QAAA,KAAI,CAAC,OAAL,CAAa,aAAb,CAA2B,IAAI,WAAJ,CAAsB,cAAtB,EAAsC;AAAE,UAAA,MAAM,EAAE,IAAV;AAAwB,UAAA,OAAO,EAAE;AAAjC,SAAtC,CAA3B;AACD,OALM,CAAP;AAMD,KA/BD;;AAiCA,QAAM,mBAAmB,GAAG,KAAK,mBAAL,GAA2B,IAAI,uBAAA,CAAA,mBAAJ,CAAwB,IAAxB,EAA8B,MAA9B,CAAvD;AACA,IAAA,mBAAmB,CAAC,OAApB,CAA4B,YAA5B,CAAyC,QAAzC,EAAmD,EAAnD;AACA,SAAK,OAAL,CAAa,WAAb,CAAyB,mBAAmB,CAAC,OAA7C;AAEA,QAAM,QAAQ,GAAG,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAjB;AACA,IAAA,QAAQ,CAAC,SAAT,CAAmB,GAAnB,CAAuB,WAAvB;AACA,IAAA,QAAQ,CAAC,SAAT,GAAqB,oLAArB;AAMA,SAAK,OAAL,CAAa,WAAb,CAAyB,QAAzB;AAEA,IAAA,QAAA,CAAA,gBAAA,CAAiB,KAAK,CAAC,MAAvB,EAA+B,IAA/B,CAAoC,UAAA,IAAA,EAAI;AACtC,UAAI,IAAJ,EAAU;AACR,QAAA,QAAQ,CAAC,SAAT,GAAqB,iCAA4B,KAAK,CAAC,QAAlC,GAA0C,MAA1C,GAAgD,KAAK,CAAC,MAAtD,GAA4D,cAA5D,GAA2E,GAA3E,GAA8E,kCAA9E,GAA8G,IAAI,CAAC,QAAnH,GAA2H,KAA3H,GAAgI,IAAI,CAAC,KAArI,GAA0I,MAA/J;AACD,OAFD,MAEO;AACL,QAAA,QAAQ,CAAC,SAAT,GAAqB,iCAA4B,KAAK,CAAC,QAAlC,GAA0C,MAA1C,GAAgD,KAAK,CAAC,MAAtD,GAA4D,cAA5D,GAA2E,GAA3E,GAA8E,kCAA9E,GAA8G,KAAK,CAAC,IAAN,CAAW,QAAzH,GAAiI,KAAjI,GAAsI,KAAK,CAAC,IAAN,CAAW,KAAjJ,GAAsJ,MAA3K;AACD;AACF,KAND;AAOD;;AAED,EAAA,cAAA,CAAA,SAAA,CAAA,OAAA,GAAA,UAAQ,IAAR,EAAkB;AAChB,SAAK,mBAAL,CAA0B,OAA1B,CAAkC,IAAlC;AACA,SAAK,iBAAL,CAAwB,OAAxB,CAAgC,IAAhC;AACD,GAHD;;AAIF,SAAA,cAAA;AAtIA,CAAA,EAAA;;AAAa,OAAA,CAAA,cAAA,GAAA,cAAA;;;;;;;;ACXb,IAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AACA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AACA,IAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AASA,IAAA,qBAAA,GAAA,OAAA,CAAA,uBAAA,CAAA;;AACA,IAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AACA,IAAA,mBAAA,GAAA,OAAA,CAAA,qBAAA,CAAA;;AAEA,IAAA,iBAAA,GAAA,YAAA;AASE,WAAA,iBAAA,CACU,KADV,EAEU,UAFV,EAGU,YAHV,EAGsC;AAHtC,QAAA,KAAA,GAAA,IAAA;;AACU,SAAA,KAAA,GAAA,KAAA;AACA,SAAA,UAAA,GAAA,UAAA;AACA,SAAA,YAAA,GAAA,YAAA;AALF,SAAA,eAAA,GAAoC,EAApC;AAON,QAAI,iBAAiB,GAAW,MAAhC;AACA,QAAI,mBAAmB,GAAW,QAAlC;;AAEA,QAAI,UAAU,IAAI,IAAlB,EAAwB;AACtB,WAAK,UAAL,GAAkB,EAAlB;AACD;;AAED,QAAI,YAAY,IAAI,IAApB,EAA0B;AACxB,WAAK,YAAL,GAAoB,EAApB;AACD;;AAED,SAAK,OAAL,GAAe,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAf;AACA,SAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,oBAA3B;AACA,SAAK,OAAL,CAAa,SAAb,GAAyB,gOAI+C,iBAJ/C,GAIgE,kJAJhE,GAKsC,mBALtC,GAKyD,iWALlF;AAiBA,SAAK,mBAAL;AAEA,QAAM,IAAI,GAAG,IAAb;AACA,QAAI,UAAU,GAAG,CAAjB;;AACA,QAAM,cAAc,GAAG,SAAjB,cAAiB,CAAC,KAAD,EAAgB,WAAhB,EAAmC;AACxD,UAAI,KAAI,CAAC,KAAT,EAAgB;AACd,YAAI,cAAc,GAAA,KAAA,CAAlB;AACA,QAAA,cAAc,GAAG,QAAA,CAAA,WAAA,CACf,KADe,EAEf,iBAAA,CAAA,cAAA,CAAK,GAFU,EAGf,KAHe,EAIf,iBAAA,CAAA,cAAA,CAAK,WAJU,EAKf,KAAI,CAAC,KALU,EAMf,IANe,CAMV,UAAA,QAAA,EAAQ;AAEb,UAAA,SAAS,CAAC,SAAV,CAAoB,MAApB,CAA2B,UAA3B;AACA,UAAA,SAAS,CAAC,SAAV,CAAoB,GAApB,CAAwB,UAAxB;AAEA,UAAA,IAAI,CAAC,UAAL,CAAiB,IAAjB,CAAsB,QAAtB;AACA,UAAA,IAAI,CAAC,mBAAL;AACA,UAAA,IAAI,CAAC,SAAL,CAAe,IAAI,CAAC,UAApB;AAEA,cAAM,aAAa,GAAG,IAAI,CAAC,OAAL,CAAa,aAAb,CAA2B,oBAA3B,CAAtB;AACA,cAAM,KAAK,GAAG,IAAI,CAAC,UAAL,GAAkB,IAAI,CAAC,UAAL,CAAgB,MAAlC,GAA2C,CAAzD;AACA,UAAA,aAAc,CAAC,WAAf,GAA6B,KAAG,KAAhC;AAEA,cAAM,UAAU,GAAG,IAAI,CAAC,SAAL,CAAe,QAAlC;AACA,cAAM,OAAO,GAAG,UAAU,CAAC,UAAU,CAAC,MAAX,GAAoB,CAArB,CAA1B;AACA,cAAM,KAAK,GAAG,OAAO,CAAC,aAAR,CAAsB,cAAtB,CAAd;AACA,cAAM,UAAU,GAAG,QAAQ,CAAC,WAAT,CAAqB,YAArB,CAAnB;AACA,UAAA,UAAU,CAAC,SAAX,CAAqB,OAArB,EAA8B,KAA9B,EAAqC,IAArC;AACA,UAAA,KAAK,CAAC,aAAN,CAAoB,UAApB;AAEA,UAAA,UAAU,GAAG,OAAO,CAAC,qBAAR,GAAgC,GAA7C;AAEA,iBAAO,QAAA,CAAA,WAAA,CAAY,QAAQ,CAAC,MAArB,EAA6B,WAA7B,CAAP;AACD,SA7BgB,CAAjB;AA+BA,eAAO,cAAc,CAAC,IAAf,CAAoB,UAAC,OAAD,EAAsB;AAC/C,cAAM,gBAAgB,GAAG,IAAI,mBAAA,CAAA,gBAAJ,CAAqB,OAArB,EAA8B,KAAI,CAAC,KAAL,CAAY,KAA1C,CAAzB;AACA,cAAM,UAAU,GAAG,IAAI,CAAC,SAAL,CAAe,QAAlC;AACA,cAAM,OAAO,GAAG,UAAU,CAAC,UAAU,CAAC,MAAX,GAAoB,CAArB,CAA1B;AACA,cAAM,MAAM,GAAG,OAAQ,CAAC,iBAAT,CAA4B,kBAA5B,CAAgD,SAA/D;AACA,UAAA,MAAO,CAAC,aAAR,CAAuB,YAAvB,CAAoC,gBAAgB,CAAC,OAArD,EAA8D,MAA9D;;AAEA,UAAA,KAAI,CAAC,iBAAL,CAAuB,KAAvB;;AACA,UAAA,KAAI,CAAC,iBAAL,CAAuB,qBAAvB;;AACA,UAAA,KAAA,CAAA,aAAA;AACA,UAAA,MAAM,CAAC,GAAP,CAAW,QAAX,CAAoB;AAClB,YAAA,GAAG,EAAE,UADa;AAElB,YAAA,QAAQ,EAAE;AAFQ,WAApB;AAID,SAdM,CAAP;AAeD;;AAED,aAAO,OAAA,CAAA,KAAA,GAAQ,IAAR,CAAa,YAAA;AAAM,eAAA,QAAA,CAAA,QAAA,EAAA;AAAU,OAA7B,EAA+B,IAA/B,CAAoC,UAAA,CAAA,EAAC;AAC1C,QAAA,KAAI,CAAC,KAAL,GAAa,CAAb;;AACA,QAAA,KAAI,CAAC,iBAAL,CAAuB,OAAvB,CAA+B,KAAI,CAAC,KAApC;;AAEA,QAAA,KAAI,CAAC,eAAL,CAAqB,OAArB,CAA6B,UAAA,SAAA,EAAS;AACpC,UAAA,SAAS,CAAC,OAAV,CAAkB,CAAlB;AACD,SAFD;AAGD,OAPM,CAAP;AAQD,KA3DD;;AA6DA,QAAM,qBAAqB,GAAG,KAAK,OAAL,CAAa,aAAb,CAA2B,wBAA3B,CAA9B;AACA,SAAK,iBAAL,GAAyB,IAAI,qBAAA,CAAA,iBAAJ,CAAsB,KAAK,KAA3B,EAAkC,cAAlC,CAAzB;AACA,IAAA,qBAAqB,CAAC,WAAtB,CAAkC,KAAK,iBAAL,CAAuB,OAAzD;AAEA,SAAK,SAAL,GAAiB,KAAK,OAAL,CAAa,aAAb,CAA2B,YAA3B,CAAjB;AACA,QAAM,SAAS,GAAG,KAAK,SAAL,GAAiB,KAAK,OAAL,CAAa,aAAb,CAA2B,YAA3B,CAAnC;AACA,QAAM,SAAS,GAAG,KAAK,SAAL,GAAiB,KAAK,OAAL,CAAa,aAAb,CAA2B,YAA3B,CAAnC;AAEA,SAAK,SAAL,CAAe,gBAAf,CAAgC,OAAhC,EAAyC,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAzC;AACA,SAAK,SAAL,CAAe,gBAAf,CAAgC,OAAhC,EAAyC,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAzC;AAEA,QAAM,SAAS,GAAG,UAAU,GAAG,UAAU,CAAC,MAAd,GAAuB,CAAnD;AACA,QAAM,WAAW,GAAG,YAAY,GAAG,YAAY,CAAC,MAAhB,GAAyB,CAAzD;AAEA,QAAM,aAAa,GAAG,SAAS,CAAC,aAAV,CAAwB,oBAAxB,CAAtB;AACA,IAAA,aAAc,CAAC,WAAf,GAA6B,KAAG,SAAhC;AACA,QAAM,mBAAmB,GAAG,SAAS,CAAC,aAAV,CAAwB,sBAAxB,CAA5B;AACA,IAAA,mBAAoB,CAAC,WAArB,GAAmC,KAAG,WAAtC;AAEA,SAAK,SAAL,CAAe,gBAAf,CAAgC,cAAhC,EAAgD,UAAA,KAAA,EAAK;AACnD,UAAI,IAAI,GAAS,KAAK,CAAC,MAAvB;;AAEA,MAAA,KAAI,CAAC,iBAAL,CAAuB,OAAvB,CAA+B,IAA/B;;AAEA,MAAA,KAAI,CAAC,eAAL,CAAqB,OAArB,CAA6B,UAAA,SAAA,EAAS;AACpC,QAAA,SAAS,CAAC,OAAV,CAAkB,IAAlB;AACD,OAFD;AAID,KATD;AAWA,SAAK,SAAL,CAAe,UAAf;AACD;;AAEO,EAAA,iBAAA,CAAA,SAAA,CAAA,mBAAA,GAAR,YAAA;AACE,QAAI,SAAS,GAAG,KAAK,UAAL,GAAkB,KAAK,UAAL,CAAgB,MAAlC,GAA2C,CAA3D;AACA,QAAI,WAAW,GAAG,KAAK,YAAL,GAAoB,KAAK,YAAL,CAAkB,MAAtC,GAA+C,CAAjE;AAEA,QAAM,OAAO,GAAG,CAAC,SAAD,IAAc,CAAC,WAA/B;AACA,QAAM,QAAQ,GAAG,SAAS,GAAG,CAAZ,IAAiB,CAAC,WAAnC;AAEA,QAAM,aAAa,GAAG,KAAK,OAAL,CAAa,aAAb,CAA2B,gBAA3B,CAAtB;AACA,QAAM,SAAS,GAAG,KAAK,OAAL,CAAa,aAAb,CAA2B,YAA3B,CAAlB;;AAEA,QAAI,OAAO,IAAI,QAAf,EAAyB;AACvB,MAAA,aAAc,CAAC,YAAf,CAA4B,QAA5B,EAAsC,EAAtC;AACD,KAFD,MAEO;AACL,MAAA,aAAc,CAAC,eAAf,CAA+B,QAA/B;AACD;;AAED,QAAI,OAAJ,EAAa;AACX,MAAA,SAAU,CAAC,YAAX,CAAwB,QAAxB,EAAkC,EAAlC;AACD,KAFD,MAEO;AACL,MAAA,SAAU,CAAC,eAAX,CAA2B,QAA3B;AACD;AACF,GArBO;;AAuBA,EAAA,iBAAA,CAAA,SAAA,CAAA,cAAA,GAAR,UAAuB,KAAvB,EAAwC;AAAxC,QAAA,KAAA,GAAA,IAAA;;AACE,QAAI,MAAM,GAAG,KAAK,CAAC,MAAnB;AACA,QAAI,YAAY,GAAG,MAAO,CAAC,aAAR,CAAuB,aAAvB,CAAqC,WAArC,CAAnB;AACA,IAAA,YAAa,CAAC,SAAd,CAAwB,MAAxB,CAA+B,UAA/B;AACA,IAAA,MAAM,CAAC,SAAP,CAAiB,GAAjB,CAAqB,UAArB;AAEA,SAAK,SAAL,CAAe,SAAf,GAA2B,4IAA3B;AAKA,IAAA,KAAA,CAAA,aAAA;AAEA,QAAI,OAAO,GAAG,MAAM,CAAC,YAAP,CAAoB,SAApB,CAAd;AACA,IAAA,QAAA,CAAA,gBAAA,CAAiB,iBAAA,CAAA,cAAA,CAAK,SAAtB,EAA2C,OAA3C,EAAoD,IAApD,CAAyD,UAAC,MAAD,EAAuB;AAC9E,UAAM,aAAa,GAAG,MAAM,CAAC,aAAP,CAAqB,MAAI,OAAJ,GAAW,eAAhC,CAAtB;AACA,UAAM,KAAK,GAAG,MAAM,GAAG,MAAM,CAAC,MAAV,GAAmB,CAAvC;AACA,MAAA,aAAc,CAAC,WAAf,GAA6B,KAAG,KAAhC;;AAEA,UAAI,OAAO,KAAK,MAAhB,EAAwB;AACtB,QAAA,KAAI,CAAC,UAAL,GAAkB,MAAlB;AAED,OAHD,MAGO;AACL,QAAA,KAAI,CAAC,YAAL,GAAoB,MAApB;AACD;;AAED,MAAA,KAAI,CAAC,mBAAL;;AACA,MAAA,KAAI,CAAC,SAAL,CAAe,MAAf;AACD,KAdD;AAeD,GA7BO;;AA+BR,EAAA,iBAAA,CAAA,SAAA,CAAA,SAAA,GAAA,UAAU,MAAV,EAAgC;AAAhC,QAAA,KAAA,GAAA,IAAA;;AACE,QAAI,SAAS,GAAG,KAAK,SAArB;AAEA,IAAA,SAAS,CAAC,SAAV,GAAsB,EAAtB;AACA,SAAK,eAAL,GAAuB,EAAvB;;AAEA,QAAI,CAAC,MAAL,EAAa;AAEX,UAAM,WAAW,GAAG,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAApB;AACA,MAAA,WAAW,CAAC,SAAZ,CAAsB,GAAtB,CAA0B,WAA1B;AACA,MAAA,WAAW,CAAC,WAAZ,GAA0B,WAA1B;AACA,MAAA,SAAS,CAAC,WAAV,CAAsB,WAAtB;AACA,MAAA,KAAA,CAAA,aAAA;AACA;AACD;;AAED,IAAA,MAAM,CAAC,OAAP,CAAe,UAAA,KAAA,EAAK;AAClB,UAAI,SAAS,GAAG,IAAI,iBAAA,CAAA,cAAJ,CAAmB,KAAnB,EAA0B,KAAI,CAAC,KAA/B,CAAhB;AACA,MAAA,SAAS,CAAC,WAAV,CAAsB,SAAS,CAAC,OAAhC;;AACA,MAAA,KAAI,CAAC,eAAL,CAAqB,IAArB,CAA0B,SAA1B;AACD,KAJD;AAMA,IAAA,KAAA,CAAA,aAAA;AACD,GAvBD;;AAwBF,SAAA,iBAAA;AA5NA,CAAA,EAAA;;AAAa,OAAA,CAAA,iBAAA,GAAA,iBAAA;;;;;;;;AChBb,IAAA,iBAAA,GAAA,OAAA,CAAA,mBAAA,CAAA;;AACA,IAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AAOA,IAAA,oBAAA,GAAA,OAAA,CAAA,sBAAA,CAAA;;AACA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAEA,QAAA,CAAA,cAAA,CAAe,iBAAA,CAAA,cAAf;AAEA,OAAO,CAAC,GAAR,CAAY,CAAC,QAAA,CAAA,QAAA,EAAD,EAAa,QAAA,CAAA,gBAAA,CAAiB,iBAAA,CAAA,cAAA,CAAK,SAAtB,EAA2C,MAA3C,CAAb,EAAiE,QAAA,CAAA,gBAAA,CAAiB,iBAAA,CAAA,cAAA,CAAK,SAAtB,EAA2C,QAA3C,CAAjE,CAAZ,EACG,IADH,CACQ,UAAC,EAAD,EAAiC;MAA/B,IAAA,GAAA,EAAA,CAAA,CAAA;MAAM,UAAA,GAAA,EAAA,CAAA,CAAA;MAAY,YAAA,GAAA,EAAA,CAAA,CAAA;AAAkB,SAAA,SAAS,CAAC,IAAD,EAAO,UAAP,EAAmB,YAAnB,CAAT;AAAyC,CADvF;;AAGA,SAAA,SAAA,CAAmB,IAAnB,EAAsC,UAAtC,EAAkE,YAAlE,EAA8F;AAC5F,EAAA,KAAA,CAAA,aAAA,CAAc,iBAAA,CAAA,cAAA,CAAK,MAAnB;AAEA,MAAM,QAAQ,GAAG,IAAI,oBAAA,CAAA,iBAAJ,CAAsB,IAAtB,EAA4B,UAA5B,EAAwC,YAAxC,CAAjB;AACA,EAAA,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,QAAQ,CAAC,OAAnC;AACA,EAAA,KAAA,CAAA,aAAA;AACD;;AAED,gBAAgB,CAAC,eAAD,EAAkB,SAAA,kBAAA,GAAA;AAChC,EAAA,mBAAmB,CAAC,eAAD,EAAkB,kBAAlB,CAAnB;AACA,EAAA,QAAQ,CAAC,aAAT,CAAuB,WAAvB,EAAqC,kBAArC,CAAwD,YAAxD,EAAsE,gHAEtB,iBAAA,CAAA,cAAA,CAAK,KAFiB,GAEZ,GAFY,GAER,iBAAA,CAAA,cAAA,CAAK,IAFG,GAEC,8RAFvE;AAQD,CAVe,CAAhB","file":"utterances.58d97600.map","sourceRoot":"..\\src","sourcesContent":["export function deparam(query: string): { [name: string]: string; } {\r\n  let match: RegExpExecArray | null;\r\n  const plus = /\\+/g;\r\n  const search = /([^&=]+)=?([^&]*)/g;\r\n  const decode = (s: string) => decodeURIComponent(s.replace(plus, ' '));\r\n  const params: { [name: string]: string; } = {};\r\n  // tslint:disable-next-line:no-conditional-assignment\r\n  while (match = search.exec(query)) {\r\n    params[decode(match[1])] = decode(match[2]);\r\n  }\r\n  return params;\r\n}\r\n\r\nexport function param(obj: any) {\r\n  const parts = [];\r\n  for (const name in obj) {\r\n    if (obj.hasOwnProperty(name)) {\r\n      parts.push(`${encodeURIComponent(name)}=${encodeURIComponent(obj[name])}`);\r\n    }\r\n  }\r\n  return parts.join('&');\r\n}\r\n","export default /^([a-z][\\w-]+)\\/([\\w-.]+)$/i;\r\n","import { deparam } from './deparam';\r\nimport repoRegex from './repo-regex';\r\n\r\nfunction readPageAttributes() {\r\n  const params = deparam(location.search.substr(1));\r\n\r\n  let issueTerm: string | null = null;\r\n  let issueNumber: number | null = null;\r\n  if ('issue-term' in params) {\r\n    issueTerm = params['issue-term'];\r\n    if (issueTerm !== undefined) {\r\n      if (issueTerm === '') {\r\n        throw new Error('When issue-term is specified, it cannot be blank.');\r\n      }\r\n      if (['title', 'url', 'pathname'].indexOf(issueTerm) !== -1) {\r\n        issueTerm = params[issueTerm];\r\n      }\r\n    }\r\n  } else if ('issue-number' in params) {\r\n    issueNumber = +params['issue-number'];\r\n    if (issueNumber.toString(10) !== params['issue-number']) {\r\n      throw new Error(`issue-number is invalid. \"${params['issue-number']}`);\r\n    }\r\n  } else {\r\n    throw new Error('\"issue-term\" or \"issue-number\" must be specified.');\r\n  }\r\n\r\n  if (!('repo' in params)) {\r\n    throw new Error('\"repo\" is required.');\r\n  }\r\n\r\n  if (!('origin' in params)) {\r\n    throw new Error('\"origin\" is required.');\r\n  }\r\n\r\n  if (!('api-endpoint' in params)) {\r\n    throw new Error('\"api-endpoint\" is required.');\r\n  }\r\n\r\n  const resourcesPath = ('resources-path' in params) ? params['resources-path'] : \"\";\r\n\r\n  const matches = repoRegex.exec(params.repo);\r\n  if (matches === null) {\r\n    throw new Error(`Invalid repo: \"${params.repo}\"`);\r\n  }\r\n\r\n  return {\r\n    owner: matches[1],\r\n    repo: matches[2],\r\n    branch: 'branch' in params ? params.branch : 'master',\r\n    configPath: 'config-path' in params ? params['config-path'] : 'utterances.json',\r\n    issueTerm,\r\n    issueNumber,\r\n    origin: params.origin,\r\n    url: params.url,\r\n    title: params.title,\r\n    description: params.description,\r\n    apiEndpoint: params['api-endpoint'],\r\n    resourcesPath: resourcesPath\r\n  };\r\n}\r\n\r\nexport const pageAttributes = readPageAttributes();\r\n","import { param } from './deparam';\r\nimport { pageAttributes as page } from './page-attributes';\r\n\r\nconst authorizeUrl = `${page.apiEndpoint}/authorize`;\r\nconst tokenUrl = `${page.apiEndpoint}/token`;\r\n// tslint:disable-next-line:variable-name\r\n\r\nconst redirect_uri = page.resourcesPath ?\r\n  `${location.origin}/${page.resourcesPath}/authorized.html` :\r\n  `${location.origin}/authorized.html`;\r\n\r\nclass Token {\r\n  private readonly storageKey = 'OAUTH_TOKEN2';\r\n  private token: string | null = null;\r\n\r\n  constructor() {\r\n    try {\r\n      this.token = localStorage.getItem(this.storageKey);\r\n      // tslint:disable-next-line:no-empty\r\n    } catch (e) { }\r\n  }\r\n\r\n  get value() {\r\n    return this.token;\r\n  }\r\n  set value(newValue) {\r\n    this.token = newValue;\r\n    try {\r\n      if (newValue === null) {\r\n        localStorage.removeItem(this.storageKey);\r\n      } else {\r\n        localStorage.setItem(this.storageKey, newValue);\r\n      }\r\n      // tslint:disable-next-line:no-empty\r\n    } catch (e) { }\r\n  }\r\n}\r\n\r\nexport const token = new Token();\r\n\r\nexport function login() {\r\n  window.open(`${authorizeUrl}?${param({ redirect_uri })}`);\r\n  return new Promise(resolve => (window as any).notifyAuthorized = resolve)\r\n    .then(search => fetch(tokenUrl + search, { mode: 'cors' }))\r\n    .then(response => {\r\n      if (response.ok) {\r\n        return response.json();\r\n      }\r\n      return response.text().then(text => Promise.reject(`Error retrieving token:\\n${text}`));\r\n    })\r\n    .then(t => { token.value = t; }, reason => { token.value = null; throw reason; });\r\n}\r\n","declare function escape(str: string): string;\r\n\r\nexport function decodeBase64UTF8(encoded: string) {\r\n  encoded = encoded.replace(/\\s/g, '');\r\n  return decodeURIComponent(escape(atob(encoded)));\r\n}\r\n","import { token } from './oauth';\r\nimport { decodeBase64UTF8 } from './encoding';\r\nimport { pageAttributes as page } from './page-attributes';\r\n\r\nconst GITHUB_API = 'https://api.github.com/';\r\nconst GITHUB_ENCODING__HTML_JSON = 'application/vnd.github.VERSION.html+json';\r\nconst GITHUB_ENCODING__HTML = 'application/vnd.github.VERSION.html';\r\nconst GITHUB_ENCODING__REACTIONS_PREVIEW = 'application/vnd.github.squirrel-girl-preview';\r\nconst PAGE_SIZE = 100;\r\n\r\nlet owner: string;\r\nlet repo: string;\r\nlet branch: string;\r\n\r\nexport function setRepoContext(context: { owner: string; repo: string; branch: string; }) {\r\n  owner = context.owner;\r\n  repo = context.repo;\r\n  branch = context.branch;\r\n}\r\n\r\nfunction githubRequest(relativeUrl: string, init?: RequestInit) {\r\n  init = init || {};\r\n  init.mode = 'cors';\r\n  init.cache = 'no-cache'; // force conditional request\r\n  const request = new Request(GITHUB_API + relativeUrl, init);\r\n  request.headers.set('Accept', GITHUB_ENCODING__REACTIONS_PREVIEW);\r\n  if (!/^search\\//.test(relativeUrl) && token.value !== null) {\r\n    request.headers.set('Authorization', `token ${token.value}`);\r\n  }\r\n  return request;\r\n}\r\n\r\nconst rateLimit = {\r\n  standard: {\r\n    limit: Number.MAX_VALUE,\r\n    remaining: Number.MAX_VALUE,\r\n    reset: 0\r\n  },\r\n  search: {\r\n    limit: Number.MAX_VALUE,\r\n    remaining: Number.MAX_VALUE,\r\n    reset: 0\r\n  }\r\n};\r\n\r\nfunction processRateLimit(response: Response) {\r\n  const limit = response.headers.get('X-RateLimit-Limit') as string;\r\n  const remaining = response.headers.get('X-RateLimit-Remaining') as string;\r\n  const reset = response.headers.get('X-RateLimit-Reset') as string;\r\n\r\n  const isSearch = /\\/search\\//.test(response.url);\r\n  const rate = isSearch ? rateLimit.search : rateLimit.standard;\r\n\r\n  rate.limit = +limit;\r\n  rate.remaining = +remaining;\r\n  rate.reset = +reset;\r\n\r\n  if (response.status === 403 && rate.remaining === 0) {\r\n    const resetDate = new Date(0);\r\n    resetDate.setUTCSeconds(rate.reset);\r\n    const mins = Math.round((resetDate.getTime() - new Date().getTime()) / 1000 / 60);\r\n    const apiType = isSearch ? 'search API' : 'non-search APIs';\r\n    // tslint:disable-next-line:no-console\r\n    console.warn(`Rate limit exceeded for ${apiType}. Resets in ${mins} minute${mins === 1 ? '' : 's'}.`);\r\n  }\r\n}\r\n\r\nfunction readRelNext(response: Response) {\r\n  const link = response.headers.get('link');\r\n  if (link === null) {\r\n    return 0;\r\n  }\r\n  const match = /\\?page=([2-9][0-9]*)>; rel=\"next\"/.exec(link);\r\n  if (match === null) {\r\n    return 0;\r\n  }\r\n  return +match[1];\r\n}\r\n\r\nfunction githubFetch(request: Request): Promise<Response> {\r\n  return fetch(request).then(response => {\r\n    if (response.status === 401) {\r\n      token.value = null;\r\n    }\r\n    if (response.status === 403) {\r\n      response.json().then(data => {\r\n        if (data.message === 'Resource not accessible by integration') {\r\n          window.dispatchEvent(new CustomEvent('not-installed'));\r\n        }\r\n      });\r\n    }\r\n\r\n    processRateLimit(response);\r\n\r\n    if (request.method === 'GET'\r\n      && [401, 403].indexOf(response.status) !== -1\r\n      && request.headers.has('Authorization')\r\n    ) {\r\n      request.headers.delete('Authorization');\r\n      return githubFetch(request);\r\n    }\r\n    return response;\r\n  });\r\n}\r\n\r\nexport function loadJsonFile<T>(path: string, html = false) {\r\n  const request = githubRequest(`repos/${owner}/${repo}/contents/${path}?ref=${branch}`);\r\n  if (html) {\r\n    request.headers.set('accept', GITHUB_ENCODING__HTML);\r\n  }\r\n  return githubFetch(request).then<FileContentsResponse | string>(response => {\r\n    if (response.status === 404) {\r\n      throw new Error(`Repo \"${owner}/${repo}\" does not have a file named \"${path}\" in the \"${branch}\" branch.`);\r\n    }\r\n    if (!response.ok) {\r\n      throw new Error(`Error fetching ${path}.`);\r\n    }\r\n    return html ? response.text() : response.json();\r\n  }).then<T>(file => {\r\n    if (html) {\r\n      return file;\r\n    }\r\n    const { content } = file as FileContentsResponse;\r\n    const decoded = decodeBase64UTF8(content);\r\n    return JSON.parse(decoded);\r\n  });\r\n}\r\n\r\nexport function loadIssuesByType(term: string, type: string) {\r\n  const q = `${term} type:issue in:body is:${type} repo:${owner}/${repo}`;\r\n  const request = githubRequest(`search/issues?q=${encodeURIComponent(q)}&sort=created&order=asc`);\r\n  return githubFetch(request).then<IssueSearchResponse>(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Error fetching issues via search.');\r\n    }\r\n    return response.json();\r\n  }).then(results => {\r\n    if (results.total_count === 0) {\r\n      return null;\r\n    }\r\n    return results.items;\r\n  });\r\n}\r\n\r\nexport function loadIssueByTerm(term: string) {\r\n  const q = `\"${term}\" is:issue in:title repo:${owner}/${repo}`;\r\n  const request = githubRequest(`search/issues?q=${encodeURIComponent(q)}&sort=created&order=asc`);\r\n  return githubFetch(request).then<IssueSearchResponse>(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Error fetching issue via search.');\r\n    }\r\n    return response.json();\r\n  }).then(results => {\r\n    if (results.total_count === 0) {\r\n      return null;\r\n    }\r\n    if (results.total_count > 1) {\r\n      // tslint:disable-next-line:no-console\r\n      console.warn(`Multiple issues match \"${q}\". Using earliest created.`);\r\n    }\r\n    return results.items[0];\r\n  });\r\n}\r\n\r\nexport function loadIssueByNumber(issueNumber: number) {\r\n  const request = githubRequest(`repos/${owner}/${repo}/issues/${issueNumber}`);\r\n  return githubFetch(request).then<Issue>(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Error fetching issue via issue number.');\r\n    }\r\n    return response.json();\r\n  });\r\n}\r\n\r\nfunction commentsRequest(issueNumber: number, page: number, pageSize?: number) {\r\n  var page_size = pageSize ? pageSize : PAGE_SIZE;\r\n  const url = `repos/${owner}/${repo}/issues/${issueNumber}/comments?page=${page}&per_page=${page_size}`;\r\n  const request = githubRequest(url);\r\n  const accept = `${GITHUB_ENCODING__HTML_JSON},${GITHUB_ENCODING__REACTIONS_PREVIEW}`;\r\n  request.headers.set('Accept', accept);\r\n  return request;\r\n}\r\n\r\nexport function loadCommentsPage(issueNumber: number, page: number) {\r\n  const request = commentsRequest(issueNumber, page);\r\n  return githubFetch(request).then(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Error fetching comments.');\r\n    }\r\n    const nextPage = readRelNext(response);\r\n    return response.json()\r\n      .then<CommentsPage>((items: IssueComment[]) => ({ items, nextPage }));\r\n  });\r\n}\r\n\r\nexport function loadIssueCreator(issueNumber: number) {\r\n  const request = commentsRequest(issueNumber, 1, 1);\r\n  return githubFetch(request).then(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Error fetching issue creator.');\r\n    }\r\n    return response.json().then<User | null>((items: IssueComment[]) => items.length ? items[0].user : null);\r\n  });\r\n}\r\n\r\nexport function loadUser(): Promise<User | null> {\r\n  if (token.value === null) {\r\n    return Promise.resolve(null);\r\n  }\r\n  return githubFetch(githubRequest('user'))\r\n    .then(response => {\r\n      if (response.ok) {\r\n        return response.json();\r\n      }\r\n      return null;\r\n    });\r\n}\r\n\r\nexport function createIssue(issueTerm: string, documentUrl: string, title: string, description: string, user: User) {\r\n  const request = new Request(`${page.apiEndpoint}/repos/${owner}/${repo}/issues`, {\r\n    method: 'POST',\r\n    body: JSON.stringify({\r\n      title: issueTerm,\r\n      body: `# ${title}\\n\\n${description}\\n\\n[${documentUrl}](${documentUrl})`,\r\n      assignees: [\r\n        user.login\r\n      ]\r\n    })\r\n  });\r\n  request.headers.set('Accept', GITHUB_ENCODING__REACTIONS_PREVIEW);\r\n  request.headers.set('Authorization', `token ${token.value}`);\r\n  return fetch(request).then<Issue>(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Error creating comments container issue');\r\n    }\r\n    return response.json();\r\n  });\r\n}\r\n\r\nexport function postComment(issueNumber: number, markdown: string) {\r\n  const url = `repos/${owner}/${repo}/issues/${issueNumber}/comments`;\r\n  const body = JSON.stringify({ body: markdown });\r\n  const request = githubRequest(url, { method: 'POST', body });\r\n  const accept = `${GITHUB_ENCODING__HTML_JSON},${GITHUB_ENCODING__REACTIONS_PREVIEW}`;\r\n  request.headers.set('Accept', accept);\r\n  return githubFetch(request).then<IssueComment>(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Error posting comment.');\r\n    }\r\n    return response.json();\r\n  });\r\n}\r\n\r\nexport function renderMarkdown(text: string) {\r\n  const body = JSON.stringify({ text, mode: 'gfm', context: `${owner}/${repo}` });\r\n  return githubFetch(githubRequest('markdown', { method: 'POST', body }))\r\n    .then(response => response.text());\r\n}\r\n\r\ninterface IssueSearchResponse {\r\n  total_count: number;\r\n  incomplete_results: boolean;\r\n  items: Issue[];\r\n}\r\n\r\nexport interface User {\r\n  login: string;\r\n  id: number;\r\n  avatar_url: string;\r\n  gravatar_id: string;\r\n  url: string;\r\n  html_url: string;\r\n  followers_url: string;\r\n  following_url: string;\r\n  gists_url: string;\r\n  starred_url: string;\r\n  subscriptions_url: string;\r\n  organizations_url: string;\r\n  repos_url: string;\r\n  events_url: string;\r\n  received_events_url: string;\r\n  type: string;\r\n}\r\n\r\nexport type CommentAuthorAssociation =\r\n  'COLLABORATOR'\r\n  | 'CONTRIBUTOR'\r\n  | 'FIRST_TIMER'\r\n  | 'FIRST_TIME_CONTRIBUTOR'\r\n  | 'MEMBER'\r\n  | 'NONE'\r\n  | 'OWNER';\r\n\r\nexport interface Issue {\r\n  url: string;\r\n  repository_url: string;\r\n  labels_url: string;\r\n  comments_url: string;\r\n  events_url: string;\r\n  html_url: string;\r\n  id: number;\r\n  number: number;\r\n  title: string;\r\n  user: User;\r\n  locked: boolean;\r\n  labels: {\r\n    url: string;\r\n    name: string;\r\n    color: string;\r\n  }[];\r\n  state: string;\r\n  assignee: null; // todo,\r\n  milestone: null; // todo,\r\n  comments: number;\r\n  created_at: string;\r\n  updated_at: string;\r\n  closed_at: null; // todo,\r\n  pull_request: {\r\n    html_url: null; // todo,\r\n    diff_url: null; // todo,\r\n    patch_url: null; // todo\r\n  };\r\n  body: string;\r\n  score: number;\r\n  reactions: {\r\n    total_count: number;\r\n    '+1': number;\r\n    '-1': number;\r\n    laugh: number;\r\n    confused: number;\r\n    heart: number;\r\n    hooray: number;\r\n    url: string;\r\n  };\r\n  author_association: CommentAuthorAssociation;\r\n}\r\n\r\ninterface FileContentsResponse {\r\n  type: string;\r\n  encoding: string;\r\n  size: number;\r\n  name: string;\r\n  path: string;\r\n  content: string;\r\n  sha: string;\r\n  url: string;\r\n  git_url: string;\r\n  html_url: string;\r\n  download_url: string;\r\n}\r\n\r\nexport interface IssueComment {\r\n  id: number;\r\n  url: string;\r\n  html_url: string;\r\n  body_html: string;\r\n  user: User;\r\n  created_at: string;\r\n  updated_at: string;\r\n  author_association: CommentAuthorAssociation;\r\n}\r\n\r\nexport interface CommentsPage {\r\n  items: IssueComment[];\r\n  nextPage: number;\r\n}\r\n\r\n/*\r\nquery IssueComments($owner: String!, $repo: String!, $issueQuery: String!) {\r\n  search(query: $issueQuery, type: ISSUE, first: 1) {\r\n    issueCount\r\n    edges {\r\n      node {\r\n        ... on Issue {\r\n          id\r\n          title,\r\n          comments(first: 100) {\r\n          \ttotalCount\r\n            edges {\r\n              node {\r\n                id,\r\n                createdAt,\r\n                bodyHTML,\r\n                author {\r\n                  avatarUrl,\r\n                  login\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  rateLimit {\r\n    cost\r\n    limit\r\n    remaining\r\n    resetAt\r\n  }\r\n\r\n  repository(owner: $owner, name: $repo) {\r\n    object(expression: \"master:utterances.json\") {\r\n      ... on Blob {\r\n        text\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n{\r\n  \"issueQuery\": \"user:jdanyow repo:utterances-demo debug\",\r\n  \"owner\": \"jdanyow\",\r\n  \"repo\": \"utterances-demo\"\r\n}\r\n*/\r\n","export interface ResizeMessage {\r\n  type: 'resize';\r\n  height: number;\r\n}\r\n\r\nlet hostOrigin: string;\r\n\r\nexport function setHostOrigin(origin: string) {\r\n  hostOrigin = origin;\r\n  addEventListener('resize', publishResize);\r\n}\r\n\r\nlet lastHeight = -1;\r\n\r\nexport function publishResize() {\r\n  const height = document.body.scrollHeight;\r\n  if (height === lastHeight) {\r\n    return;\r\n  }\r\n  lastHeight = height;\r\n  const message: ResizeMessage = { type: 'resize', height };\r\n  parent.postMessage(message, hostOrigin);\r\n}\r\n","import { publishResize } from './bus';\r\nimport { User } from './github';\r\n\r\n// tslint:disable-next-line:max-line-length\r\nconst anonymousAvatar = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14 16\" version=\"1.1\"><path fill=\"rgb(179,179,179)\" fill-rule=\"evenodd\" d=\"M8 10.5L9 14H5l1-3.5L5.25 9h3.5L8 10.5zM10 6H4L2 7h10l-2-1zM9 2L7 3 5 2 4 5h6L9 2zm4.03 7.75L10 9l1 2-2 3h3.22c.45 0 .86-.31.97-.75l.56-2.28c.14-.53-.19-1.08-.72-1.22zM4 9l-3.03.75c-.53.14-.86.69-.72 1.22l.56 2.28c.11.44.52.75.97.75H5l-2-3 1-2z\"></path></svg>`;\r\n// base64 encoding works in IE, Edge. UTF-8 does not.\r\nconst anonymousAvatarUrl = `data:image/svg+xml;base64,${btoa(anonymousAvatar)}`;\r\n\r\nexport class NewIssueComponent {\r\n  public readonly element: HTMLElement;\r\n\r\n  private avatarAnchor: HTMLAnchorElement;\r\n  private avatar: HTMLImageElement;\r\n  private form: HTMLFormElement;\r\n  private input: HTMLInputElement;\r\n  private textarea: HTMLTextAreaElement;\r\n  private submitButton: HTMLButtonElement;\r\n\r\n  private newIssueTimelineComment: HTMLElement;\r\n  private newIssueThanksForFeedback: HTMLElement;\r\n\r\n  private submitting = false;\r\n\r\n  constructor(\r\n    private user: User | null,\r\n    private readonly submit: (titie: string, description: string) => Promise<void>\r\n  ) {\r\n    this.element = document.createElement('article');\r\n    this.element.addEventListener('mousemove', publishResize); // todo: measure, throttle\r\n\r\n    this.element.innerHTML = `\r\n      <article id=\"newIssueTimelineComment\" class=\"timeline-comment\">\r\n        <a class=\"avatar\" target=\"_blank\">\r\n          <img height=\"44\" width=\"44\">\r\n        </a>\r\n        <form class=\"comment\" accept-charset=\"UTF-8\" action=\"javascript:\">\r\n          <header class=\"comment-header\">\r\n            <strong>Submit your feedback</strong>\r\n          </header>\r\n          <div class=\"comment-body\">\r\n            <input class=\"form-control input-block\" placeholder=\"Title\"/>\r\n            <textarea placeholder=\"Leave your comment\" aria-label=\"comment\"></textarea>\r\n          </div>\r\n          <footer class=\"comment-footer\">\r\n            <a class=\"text-link markdown-info\" tabindex=\"-1\" target=\"_blank\"\r\n              href=\"https://guides.github.com/features/mastering-markdown/\">\r\n              Styling with Markdown is supported\r\n            </a>\r\n            <button class=\"btn btn-primary\" type=\"submit\">Submit Comment</button>\r\n          </footer>\r\n        </form>\r\n      </article>\r\n      <article id=\"newIssueThanksForFeedback\" class=\"timeline-comment\" hidden>\r\n        <header class=\"comment-header feedback-thanks\"><strong>Thanks for submitting your feedback. Click this message to submit more.</strong></header>\r\n      </article>`;\r\n\r\n    this.avatarAnchor = this.element.querySelector('.avatar') as HTMLAnchorElement;\r\n    this.avatar = this.avatarAnchor.firstElementChild as HTMLImageElement;\r\n    this.form = this.avatarAnchor.nextElementSibling as HTMLFormElement;\r\n    this.input = this.form!.firstElementChild!.nextElementSibling!.firstElementChild as HTMLInputElement;\r\n    this.textarea = this.input!.nextElementSibling as HTMLTextAreaElement;\r\n    this.submitButton = this.form!.lastElementChild!.lastElementChild as HTMLButtonElement;\r\n\r\n    this.newIssueTimelineComment = this.element.querySelector('#newIssueTimelineComment') as HTMLElement;\r\n    this.newIssueThanksForFeedback = this.element.querySelector('#newIssueThanksForFeedback') as HTMLElement;\r\n\r\n    this.newIssueThanksForFeedback.addEventListener('click', () => {\r\n      this.newIssueThanksForFeedback.setAttribute('hidden', '');\r\n      this.newIssueTimelineComment.removeAttribute('hidden');\r\n    });\r\n\r\n    this.setUser(user);\r\n\r\n    this.textarea.addEventListener('input', this.handleInput);\r\n    this.form.addEventListener('submit', this.handleSubmit);\r\n  }\r\n\r\n  public showThanksForFeedback() {\r\n    this.newIssueThanksForFeedback.removeAttribute('hidden');\r\n    this.newIssueTimelineComment.setAttribute('hidden', '');\r\n  }\r\n\r\n  public setUser(user: User | null) {\r\n    this.user = user;\r\n    this.submitButton.textContent = user ? 'Submit Comment' : 'Sign in to comment';\r\n    this.submitButton.disabled = !!user;\r\n\r\n    if (user) {\r\n      this.avatarAnchor.href = user.html_url;\r\n      this.avatar.alt = '@' + user.login;\r\n      this.avatar.src = user.avatar_url + '?v=3&s=88';\r\n    } else {\r\n      this.avatarAnchor.removeAttribute('href');\r\n      this.avatar.alt = '@anonymous';\r\n      this.avatar.src = anonymousAvatarUrl;\r\n    }\r\n  }\r\n\r\n  public clear() {\r\n    this.textarea.value = '';\r\n    this.input.value = '';\r\n  }\r\n\r\n  private handleInput = () => {\r\n    this.submitButton.disabled = /^\\s*$/.test(this.textarea.value);\r\n    if (this.textarea.scrollHeight < 450 && this.textarea.offsetHeight < this.textarea.scrollHeight) {\r\n      this.textarea.style.height = `${this.textarea.scrollHeight}px`;\r\n      publishResize();\r\n    }\r\n  }\r\n\r\n  private handleSubmit = (event: Event) => {\r\n    event.preventDefault();\r\n    if (this.submitting) {\r\n      return;\r\n    }\r\n    this.submitting = true;\r\n    if (this.user) {\r\n      this.textarea.disabled = true;\r\n      this.submitButton.disabled = true;\r\n    }\r\n    this.submit(this.input.value, this.textarea.value).catch(() => 0).then(() => {\r\n      this.submitting = false;\r\n      this.textarea.disabled = !this.user;\r\n      this.textarea.value = '';\r\n      this.submitButton.disabled = false;\r\n    });\r\n  }\r\n}\r\n","// todo: take a dependency on some relative time library.\r\n\r\nconst thresholds = [\r\n  1000, 'second',\r\n  1000 * 60, 'minute',\r\n  1000 * 60 * 60, 'hour',\r\n  1000 * 60 * 60 * 24, 'day',\r\n  1000 * 60 * 60 * 24 * 7, 'week',\r\n  1000 * 60 * 60 * 24 * 27, 'month'\r\n];\r\n\r\nconst formatOptions: Intl.DateTimeFormatOptions = { month: 'short', day: 'numeric', year: 'numeric' };\r\n\r\nexport function timeAgo(current: number, value: Date) {\r\n  const elapsed = current - value.getTime();\r\n  if (elapsed < 5000) {\r\n    return 'just now';\r\n  }\r\n  let i = 0;\r\n  while (i + 2 < thresholds.length && elapsed * 1.1 > thresholds[i + 2]) {\r\n    i += 2;\r\n  }\r\n\r\n  const divisor = thresholds[i] as number;\r\n  const text = thresholds[i + 1] as string;\r\n  const units = Math.round(elapsed / divisor);\r\n\r\n  if (units > 3 && i === thresholds.length - 2) {\r\n    return `on ${value.toLocaleDateString(undefined, formatOptions)}`;\r\n  }\r\n  return units === 1 ? `${text === 'hour' ? 'an' : 'a'} ${text} ago` : `${units} ${text}s ago`;\r\n}\r\n","import { IssueComment } from './github';\r\nimport { timeAgo } from './time-ago';\r\n\r\nconst avatarArgs = '?v=3&s=88';\r\nconst displayAssociations: { [association: string]: string; } = {\r\n  COLLABORATOR: 'Collaborator',\r\n  CONTRIBUTOR: 'Contributor',\r\n  MEMBER: 'Member',\r\n  OWNER: 'Owner'\r\n};\r\n\r\nexport class CommentComponent {\r\n  public readonly element: HTMLElement;\r\n\r\n  constructor(\r\n    public comment: IssueComment,\r\n    private currentUser: string | null\r\n  ) {\r\n    const { user, html_url, created_at, body_html, author_association } = comment;\r\n    this.element = document.createElement('article');\r\n    this.element.classList.add('timeline-comment');\r\n    if (user.login === currentUser) {\r\n      this.element.classList.add('current-user');\r\n    }\r\n    const association = displayAssociations[author_association];\r\n    this.element.innerHTML = `\r\n      <a class=\"avatar\" href=\"${user.html_url}\" target=\"_blank\" tabindex=\"-1\">\r\n        <img alt=\"@${user.login}\" height=\"44\" width=\"44\"\r\n              src=\"${user.avatar_url}${avatarArgs}\">\r\n      </a>\r\n      <div class=\"comment\">\r\n        <header class=\"comment-header\">\r\n          <span class=\"comment-meta\">\r\n            <a class=\"text-link\" href=\"${user.html_url}\" target=\"_blank\"><strong>${user.login}</strong></a>\r\n            commented\r\n            <a class=\"text-link\" href=\"${html_url}\" target=\"_blank\">${timeAgo(Date.now(), new Date(created_at))}</a>\r\n          </span>\r\n          ${association ? `<span class=\"author-association-badge\">${association}</span>` : ''}\r\n        </header>\r\n        <div class=\"markdown-body markdown-body-scrollable\">\r\n          ${body_html}\r\n        </div>\r\n      </div>`;\r\n\r\n    this.retargetLinks();\r\n  }\r\n\r\n  public setCurrentUser(currentUser: string | null) {\r\n    if (this.currentUser === currentUser) {\r\n      return;\r\n    }\r\n    this.currentUser = currentUser;\r\n\r\n    if (this.comment.user.login === this.currentUser) {\r\n      this.element.classList.add('current-user');\r\n    } else {\r\n      this.element.classList.remove('current-user');\r\n    }\r\n  }\r\n\r\n  private retargetLinks() {\r\n    const links = this.element.lastElementChild!.lastElementChild!.querySelectorAll('a');\r\n    let j = links.length;\r\n    while (j--) {\r\n      const link = links.item(j);\r\n      link.target = '_blank';\r\n    }\r\n  }\r\n}\r\n","import { User, IssueComment } from './github';\r\nimport { CommentComponent } from './comment-component';\r\nimport { publishResize } from './bus';\r\n\r\nexport class TimelineComponent {\r\n  public readonly element: HTMLElement;\r\n  private readonly timeline: CommentComponent[] = [];\r\n  private readonly marker: Node;\r\n\r\n  constructor(\r\n    private user: User | null\r\n  ) {\r\n    this.element = document.createElement('section');\r\n    this.element.classList.add('timeline');\r\n    this.marker = document.createComment('marker');\r\n    this.element.appendChild(this.marker);\r\n  }\r\n\r\n  public setUser(user: User | null) {\r\n    this.user = user;\r\n    const login = user ? user.login : null;\r\n    for (let i = 0; i < this.timeline.length; i++) {\r\n      this.timeline[i].setCurrentUser(login);\r\n    }\r\n    publishResize();\r\n  }\r\n\r\n  public appendComment(comment: IssueComment) {\r\n    const component = new CommentComponent(\r\n      comment,\r\n      this.user ? this.user.login : null);\r\n    this.timeline.push(component);\r\n    this.element.insertBefore(component.element, this.marker);\r\n    publishResize();\r\n  }\r\n}\r\n","import { User, renderMarkdown } from './github';\r\nimport { publishResize } from './bus';\r\n\r\n// tslint:disable-next-line:max-line-length\r\nconst anonymousAvatar = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14 16\" version=\"1.1\"><path fill=\"rgb(179,179,179)\" fill-rule=\"evenodd\" d=\"M8 10.5L9 14H5l1-3.5L5.25 9h3.5L8 10.5zM10 6H4L2 7h10l-2-1zM9 2L7 3 5 2 4 5h6L9 2zm4.03 7.75L10 9l1 2-2 3h3.22c.45 0 .86-.31.97-.75l.56-2.28c.14-.53-.19-1.08-.72-1.22zM4 9l-3.03.75c-.53.14-.86.69-.72 1.22l.56 2.28c.11.44.52.75.97.75H5l-2-3 1-2z\"></path></svg>`;\r\n// base64 encoding works in IE, Edge. UTF-8 does not.\r\nconst anonymousAvatarUrl = `data:image/svg+xml;base64,${btoa(anonymousAvatar)}`;\r\n\r\nconst nothingToPreview = 'Nothing to preview';\r\n\r\nexport class NewCommentComponent {\r\n  public readonly element: HTMLElement;\r\n\r\n  private avatarAnchor: HTMLAnchorElement;\r\n  private avatar: HTMLImageElement;\r\n  private form: HTMLFormElement;\r\n  private textarea: HTMLTextAreaElement;\r\n  private preview: HTMLDivElement;\r\n  private submitButton: HTMLButtonElement;\r\n\r\n  private submitting = false;\r\n  private renderTimeout = 0;\r\n\r\n  constructor(\r\n    private user: User | null,\r\n    private readonly submit: (markdown: string) => Promise<void>\r\n  ) {\r\n    this.element = document.createElement('article');\r\n    this.element.classList.add('timeline-comment');\r\n    this.element.addEventListener('mousemove', publishResize); // todo: measure, throttle\r\n\r\n    this.element.innerHTML = `\r\n      <a class=\"avatar\" target=\"_blank\" tabindex=\"-1\">\r\n        <img height=\"44\" width=\"44\">\r\n      </a>\r\n      <form class=\"comment\" accept-charset=\"UTF-8\" action=\"javascript:\">\r\n        <header class=\"new-comment-header\">\r\n          <nav class=\"tabnav-tabs\" role=\"tablist\">\r\n            <button type=\"button\" class=\"tabnav-tab tab-write selected\"\r\n                    role=\"tab\" aria-selected=\"true\">\r\n              Write\r\n            </button>\r\n            <button type=\"button\" class=\"tabnav-tab tab-preview\"\r\n                    role=\"tab\">\r\n              Preview\r\n            </button>\r\n          </nav>\r\n        </header>\r\n        <div class=\"comment-body\">\r\n          <textarea placeholder=\"Leave a comment\" aria-label=\"comment\"></textarea>\r\n          <div class=\"markdown-body\" style=\"display: none\">\r\n            ${nothingToPreview}\r\n          </div>\r\n        </div>\r\n        <footer class=\"comment-footer\">\r\n          <a class=\"text-link markdown-info\" tabindex=\"-1\" target=\"_blank\"\r\n             href=\"https://guides.github.com/features/mastering-markdown/\">\r\n            Styling with Markdown is supported\r\n          </a>\r\n          <button class=\"btn btn-primary\" type=\"submit\">Submit Comment</button>\r\n        </footer>\r\n      </form>`;\r\n\r\n    this.avatarAnchor = this.element.firstElementChild as HTMLAnchorElement;\r\n    this.avatar = this.avatarAnchor.firstElementChild as HTMLImageElement;\r\n    this.form = this.avatarAnchor.nextElementSibling as HTMLFormElement;\r\n    this.textarea = this.form!.firstElementChild!.nextElementSibling!.firstElementChild as HTMLTextAreaElement;\r\n    this.preview = this.form!.firstElementChild!.nextElementSibling!.lastElementChild as HTMLDivElement;\r\n    this.submitButton = this.form!.lastElementChild!.lastElementChild as HTMLButtonElement;\r\n\r\n    this.setUser(user);\r\n\r\n    this.textarea.addEventListener('input', this.handleInput);\r\n    this.form.addEventListener('submit', this.handleSubmit);\r\n    this.form.addEventListener('click', this.handleClick);\r\n  }\r\n\r\n  public setUser(user: User | null) {\r\n    this.user = user;\r\n    this.submitButton.textContent = user ? 'Submit Comment' : 'Sign in to comment';\r\n    this.submitButton.disabled = !!user;\r\n\r\n    if (user) {\r\n      this.avatarAnchor.href = user.html_url;\r\n      this.avatar.alt = '@' + user.login;\r\n      this.avatar.src = user.avatar_url + '?v=3&s=88';\r\n    } else {\r\n      this.avatarAnchor.removeAttribute('href');\r\n      this.avatar.alt = '@anonymous';\r\n      this.avatar.src = anonymousAvatarUrl;\r\n    }\r\n  }\r\n\r\n  public clear() {\r\n    this.textarea.value = '';\r\n  }\r\n\r\n  private handleInput = () => {\r\n    const text = this.textarea.value;\r\n    const isWhitespace = /^\\s*$/.test(text);\r\n    this.submitButton.disabled = isWhitespace;\r\n    if (this.textarea.scrollHeight < 450 && this.textarea.offsetHeight < this.textarea.scrollHeight) {\r\n      this.textarea.style.height = `${this.textarea.scrollHeight}px`;\r\n      publishResize();\r\n    }\r\n\r\n    clearTimeout(this.renderTimeout);\r\n    if (isWhitespace) {\r\n      this.preview.textContent = nothingToPreview;\r\n    } else {\r\n      this.preview.textContent = 'Loading preview...';\r\n      this.renderTimeout = setTimeout(\r\n        () => renderMarkdown(text).then(html => this.preview.innerHTML = html).then(publishResize),\r\n        500);\r\n    }\r\n  }\r\n\r\n  private handleSubmit = (event: Event) => {\r\n    event.preventDefault();\r\n    if (this.submitting) {\r\n      return;\r\n    }\r\n    this.submitting = true;\r\n    if (this.user) {\r\n      this.submitButton.disabled = true;\r\n    }\r\n    this.submit(this.textarea.value).catch(() => 0).then(() => {\r\n      this.submitting = false;\r\n      this.textarea.value = '';\r\n      this.submitButton.disabled = false;\r\n      this.handleClick({ target: this.form.querySelector('.tabnav-tab.tab-write') } as any);\r\n      this.preview.textContent = nothingToPreview;\r\n    });\r\n  }\r\n\r\n  private handleClick = ({ target }: Event) => {\r\n    if (!(target instanceof HTMLButtonElement) || !target.classList.contains('tabnav-tab')) {\r\n      return;\r\n    }\r\n    if (target.classList.contains('selected')) {\r\n      return;\r\n    }\r\n    this.form.querySelector('.tabnav-tab.selected')!.classList.remove('selected');\r\n    target.classList.add('selected');\r\n    const isPreview = target.classList.contains('tab-preview');\r\n    this.textarea.style.display = isPreview ? 'none' : '';\r\n    this.preview.style.display = isPreview ? '' : 'none';\r\n    publishResize();\r\n  }\r\n}\r\n","import { pageAttributes as page } from './page-attributes';\r\nimport { publishResize } from './bus';\r\nimport {\r\n  User, Issue, IssueComment, createIssue, postComment, loadUser, loadCommentsPage, loadIssueCreator\r\n} from './github'\r\nimport { login } from './oauth';\r\nimport { TimelineComponent } from './timeline-component';\r\nimport { NewCommentComponent } from './new-comment-component';\r\n\r\ndeclare var window: any;\r\n\r\nexport class IssueComponent {\r\n  public readonly element: HTMLElement;\r\n  private timelineComponent: TimelineComponent | null;\r\n  private newCommentComponent: NewCommentComponent | null;\r\n  private rightArrow: HTMLElement;\r\n  private downArrow: HTMLElement;\r\n  private commentCount: Number;\r\n\r\n  constructor(issue: Issue, user: User | null) {\r\n    let commentCount = this.commentCount = issue.comments;\r\n    let ago = window[\"moment\"](issue.created_at).fromNow();\r\n    this.element = document.createElement('div');\r\n    this.element.classList.add('Box-row');\r\n    this.element.innerHTML = `\r\n      <div class=\"issue-box\">\r\n        <div class=\"arrow arrow-right\"></div>\r\n        <div class=\"arrow arrow-down\" hidden></div>\r\n        <div class=\"issue-title\"><span class=\"issue-title-text\">${issue.title}</span></div>\r\n        <a id=\"viewInGithub\" hidden class=\"view-in-github-box\" target=\"_blank\" href=\"${issue.html_url}\">View in Github</a>\r\n        <div class=\"comment-count-container\">\r\n          <span class=\"comment-icon\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 50 50\" version=\"1.1\" fill=\"#333333\" width=\"50px\" height=\"50px\">\r\n              <g id=\"surface1\" fill=\"#333333\"><path style=\" \" d=\"M 7 4 C 4.253906 4 2 6.253906 2 9 L 2 33 C 2 35.746094 4.253906 38 7 38 L 11.09375 38 C 11.230469 39.203125 11.214844 40.316406 10.90625 41.25 C 10.527344 42.398438 9.820313 43.363281 8.5 44.15625 C 8.128906 44.390625 7.957031 44.839844 8.070313 45.261719 C 8.183594 45.683594 8.5625 45.984375 9 46 C 13.242188 46 18.105469 43.785156 20.5625 38 L 43 38 C 45.746094 38 48 35.746094 48 33 L 48 9 C 48 6.253906 45.746094 4 43 4 Z M 7 6 L 43 6 C 44.65625 6 46 7.34375 46 9 L 46 33 C 46 34.65625 44.65625 36 43 36 L 20 36 C 19.582031 36 19.207031 36.261719 19.0625 36.65625 C 17.507813 40.898438 14.730469 42.917969 11.84375 43.65625 C 12.234375 43.097656 12.605469 42.507813 12.8125 41.875 C 13.332031 40.296875 13.289063 38.570313 12.96875 36.8125 C 12.878906 36.347656 12.476563 36.007813 12 36 L 7 36 C 5.34375 36 4 34.65625 4 33 L 4 9 C 4 7.34375 5.34375 6 7 6 Z \" fill=\"#333333\"/></g>\r\n            </svg>\r\n          </span>\r\n          <span class=\"count-text\">${commentCount}</span>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    const rightArrow = this.rightArrow = this.element.querySelector(\".arrow-right\") as HTMLElement;\r\n    const downArrow = this.downArrow = this.element.querySelector(\".arrow-down\") as HTMLElement;\r\n    const commentCountContainer = this.element.querySelector('.comment-count-container') as HTMLElement;\r\n    const commentCountElt = this.element.querySelector('.count-text') as HTMLElement;\r\n    const issueTitleText = this.element.querySelector('.issue-title-text') as HTMLElement;\r\n    const viewInGithub = this.element.querySelector('#viewInGithub') as HTMLElement;\r\n\r\n    const toggleHidden = (): void => {\r\n      let isOpen = rightArrow.hasAttribute('hidden');\r\n      if (isOpen) {\r\n        rightArrow.removeAttribute('hidden');\r\n        downArrow.setAttribute('hidden', '');\r\n        timeline.element.setAttribute('hidden', '');\r\n        newCommentComponent.element.setAttribute('hidden', '');\r\n        viewInGithub.setAttribute('hidden', '');\r\n\r\n      } else {\r\n        rightArrow.setAttribute('hidden', '');\r\n        downArrow.removeAttribute('hidden');\r\n        timeline.element.removeAttribute('hidden');\r\n        newCommentComponent.element.removeAttribute('hidden');\r\n        viewInGithub.removeAttribute('hidden');\r\n      }\r\n\r\n      publishResize();\r\n    }\r\n\r\n    rightArrow.addEventListener('click', toggleHidden);\r\n    downArrow.addEventListener('click', toggleHidden);\r\n\r\n    commentCountContainer.addEventListener('click', toggleHidden);\r\n    issueTitleText.addEventListener('click', toggleHidden);\r\n\r\n    if (issue && issue.comments > 0) {\r\n      loadCommentsPage(issue.number, 1).then(commentsPage => {\r\n        commentsPage.items.forEach(item => {\r\n          timeline.appendComment(item);\r\n        });\r\n      });\r\n    }\r\n    const timeline = this.timelineComponent = new TimelineComponent(user);\r\n    timeline.element.setAttribute('hidden', '');\r\n    this.element.appendChild(this.timelineComponent.element);\r\n\r\n    const submit = (markdown: string) => {\r\n      if (user) {\r\n        let commentPromise: Promise<IssueComment>;\r\n        if (issue) {\r\n          commentPromise = postComment(issue.number, markdown);\r\n        } else {\r\n          commentPromise = createIssue(\r\n            page.issueTerm as string,\r\n            page.url,\r\n            page.title,\r\n            page.description,\r\n            user\r\n          ).then(newIssue => {\r\n            issue = newIssue;\r\n            return postComment(issue.number, markdown);\r\n          });\r\n        }\r\n        return commentPromise.then(comment => {\r\n          timeline.appendComment(comment);\r\n          ++commentCount;\r\n          commentCountElt!.textContent = commentCount + '';\r\n          newCommentComponent.clear();\r\n        });\r\n      }\r\n\r\n      return login().then(() => loadUser()).then(u => {\r\n        user = u;\r\n        timeline.setUser(user);\r\n        newCommentComponent.setUser(user);\r\n        this.element.dispatchEvent(new CustomEvent<User>('user-changed', { detail: user as User, bubbles: true }));\r\n      });\r\n    };\r\n\r\n    const newCommentComponent = this.newCommentComponent = new NewCommentComponent(user, submit);\r\n    newCommentComponent.element.setAttribute('hidden', '');\r\n    this.element.appendChild(newCommentComponent.element);\r\n\r\n    const issueSub = document.createElement('div');\r\n    issueSub.classList.add('issue-sub');\r\n    issueSub.innerHTML = `\r\n      <div class=\"spinner spinner-size-21\">\r\n        <div class=\"bounce1\"></div>\r\n        <div class=\"bounce2\"></div>\r\n        <div class=\"bounce3\"></div>\r\n      </div>`;\r\n    this.element.appendChild(issueSub);\r\n\r\n    loadIssueCreator(issue.number).then(user => {\r\n      if (user) {\r\n        issueSub.innerHTML = `<a target=\"_blank\" href=\"${issue.html_url}\">#${issue.number}</a> opened ${ago} by <a target=\"_blank\" href=\"${user.html_url}\">${user.login}</a>`;\r\n      } else {\r\n        issueSub.innerHTML = `<a target=\"_blank\" href=\"${issue.html_url}\">#${issue.number}</a> opened ${ago} by <a target=\"_blank\" href=\"${issue.user.html_url}\">${issue.user.login}</a>`;\r\n      }\r\n    });\r\n  }\r\n\r\n  setUser(user: User) {\r\n    this.newCommentComponent!.setUser(user);\r\n    this.timelineComponent!.setUser(user);\r\n  }\r\n}\r\n","import { pageAttributes as page } from './page-attributes';\nimport { login } from './oauth';\nimport { publishResize } from './bus';\nimport {\n  Issue,\n  IssueComment,\n  User,\n  postComment,\n  createIssue,\n  loadIssuesByType,\n  loadUser\n} from './github';\nimport { NewIssueComponent } from './new-issue-component';\nimport { IssueComponent } from './issue-component';\nimport { CommentComponent } from './comment-component';\n\nexport class FeedbackComponent {\n  public readonly element: HTMLElement;\n  private openedTab: HTMLAnchorElement;\n  private closedTab: HTMLAnchorElement;\n  private issuesBox: HTMLElement;\n\n  private newIssueComponent: NewIssueComponent;\n  private issueComponents: IssueComponent[] = [];\n\n  constructor(\n    private _user: User | null,\n    private openIssues: Issue[] | null,\n    private closedIssues: Issue[] | null\n  ) {\n    let openIssuesTabName: string = 'open';\n    let closedIssuesTabName: string = 'closed';\n\n    if (openIssues == null) {\n      this.openIssues = [];\n    }\n\n    if (closedIssues == null) {\n      this.closedIssues = [];\n    }\n\n    this.element = document.createElement('div');\n    this.element.classList.add('feedback-container');\n    this.element.innerHTML = `\n      <div id=\"newIssueFormContainer\"></div>\n      <div id=\"tabsContainer\" class=\"tabnav\">\n        <nav class=\"tabnav-tabs\">\n          <a id=\"openedTab\" link=\"#\" class=\"tabnav-tab selected\" tabname=\"${openIssuesTabName}\"><span id=\"openTabIssueCount\" class=\"text-bold\"></span> Open</a>\n          <a id=\"closedTab\" link=\"#\" class=\"tabnav-tab\" tabname=\"${closedIssuesTabName}\"><span id=\"closedTabIssueCount\" class=\"text-bold\"></span> Closed</a>\n        </nav>\n      </div>\n      <div id=\"issuesBox\" class=\"Box issues-box\">\n        <div class=\"spinner\">\n          <div class=\"bounce1\"></div>\n          <div class=\"bounce2\"></div>\n          <div class=\"bounce3\"></div>\n        </div>\n      </div>\n    `;\n\n    this.updateTabVisibility();\n\n    const self = this;\n    let lastBoxTop = 0;\n    const newIssueSubmit = (title: string, description: string): Promise<void> => {\n      if (this._user) {\n        let commentPromise: Promise<IssueComment>;\n        commentPromise = createIssue(\n          title,\n          page.url,\n          title,\n          page.description,\n          this._user\n        ).then(newIssue => {\n\n          closedTab.classList.remove('selected');\n          openedTab.classList.add('selected');\n\n          self.openIssues!.push(newIssue);\n          self.updateTabVisibility();\n          self.setIssues(self.openIssues);\n\n          const issueCountElt = self.element.querySelector(`#openTabIssueCount`);\n          const count = self.openIssues ? self.openIssues.length : 0;\n          issueCountElt!.textContent = `${count}`;\n\n          const issueBoxes = self.issuesBox.children;\n          const lastBox = issueBoxes[issueBoxes.length - 1];\n          const arrow = lastBox.querySelector('.arrow-right') as HTMLElement;\n          const clickEvent = document.createEvent('MouseEvent');\n          clickEvent.initEvent('click', false, true);\n          arrow.dispatchEvent(clickEvent);\n\n          lastBoxTop = lastBox.getBoundingClientRect().top;\n\n          return postComment(newIssue.number, description);\n        });\n\n        return commentPromise.then((comment: IssueComment) => {\n          const commentComponent = new CommentComponent(comment, this._user!.login);\n          const issueBoxes = self.issuesBox.children;\n          const lastBox = issueBoxes[issueBoxes.length - 1];\n          const marker = lastBox!.firstElementChild!.nextElementSibling!.lastChild as Node;\n          marker!.parentElement!.insertBefore(commentComponent.element, marker);\n\n          this.newIssueComponent.clear();\n          this.newIssueComponent.showThanksForFeedback();\n          publishResize();\n          window.top.scrollTo({\n            top: lastBoxTop,\n            behavior: \"smooth\"\n          });\n        });\n      }\n\n      return login().then(() => loadUser()).then(u => {\n        this._user = u;\n        this.newIssueComponent.setUser(this._user);\n\n        this.issueComponents.forEach(component => {\n          component.setUser(u as User);\n        });\n      });\n    };\n\n    const newIssueFormContainer = this.element.querySelector('#newIssueFormContainer') as HTMLElement;\n    this.newIssueComponent = new NewIssueComponent(this._user, newIssueSubmit);\n    newIssueFormContainer.appendChild(this.newIssueComponent.element);\n\n    this.issuesBox = this.element.querySelector('#issuesBox') as HTMLElement;\n    const openedTab = this.openedTab = this.element.querySelector('#openedTab') as HTMLAnchorElement;\n    const closedTab = this.closedTab = this.element.querySelector('#closedTab') as HTMLAnchorElement;\n\n    this.openedTab.addEventListener('click', this.handleTabClick.bind(this));\n    this.closedTab.addEventListener('click', this.handleTabClick.bind(this));\n\n    const openCount = openIssues ? openIssues.length : 0;\n    const closedCount = closedIssues ? closedIssues.length : 0;\n\n    const issueCountElt = openedTab.querySelector('#openTabIssueCount');\n    issueCountElt!.textContent = `${openCount}`;\n    const closedIssueCountElt = closedTab.querySelector('#closedTabIssueCount');\n    closedIssueCountElt!.textContent = `${closedCount}`;\n\n    this.issuesBox.addEventListener('user-changed', event => {\n      let user: User = event.detail as User;\n\n      this.newIssueComponent.setUser(user);\n\n      this.issueComponents.forEach(component => {\n        component.setUser(user);\n      });\n\n    });\n\n    this.setIssues(openIssues);\n  }\n\n  private updateTabVisibility(): void {\n    var openCount = this.openIssues ? this.openIssues.length : 0;\n    var closedCount = this.closedIssues ? this.closedIssues.length : 0;\n\n    const hideAll = !openCount && !closedCount;\n    const hideTabs = openCount > 0 && !closedCount;\n\n    const tabsContainer = this.element.querySelector('#tabsContainer') as HTMLElement;\n    const issuesBox = this.element.querySelector('#issuesBox') as HTMLElement;\n\n    if (hideAll || hideTabs) {\n      tabsContainer!.setAttribute('hidden', '');\n    } else {\n      tabsContainer!.removeAttribute('hidden');\n    }\n\n    if (hideAll) {\n      issuesBox!.setAttribute('hidden', '');\n    } else {\n      issuesBox!.removeAttribute('hidden');\n    }\n  }\n\n  private handleTabClick(event: MouseEvent): void {\n    var target = event.target as HTMLAnchorElement;\n    var prevSelected = target!.parentElement!.querySelector('.selected');\n    prevSelected!.classList.remove('selected');\n    target.classList.add('selected');\n\n    this.issuesBox.innerHTML = `<div class=\"spinner\">\n    <div class=\"bounce1\"></div>\n    <div class=\"bounce2\"></div>\n    <div class=\"bounce3\"></div>\n  </div>`;\n    publishResize();\n\n    let tabName = target.getAttribute('tabname') as string;\n    loadIssuesByType(page.issueTerm as string, tabName).then((issues: Issue[] | null) => {\n      const issueCountElt = target.querySelector(`#${tabName}TabIssueCount`);\n      const count = issues ? issues.length : 0;\n      issueCountElt!.textContent = `${count}`;\n\n      if (tabName === \"open\") {\n        this.openIssues = issues;\n\n      } else {\n        this.closedIssues = issues;\n      }\n\n      this.updateTabVisibility();\n      this.setIssues(issues);\n    });\n  }\n\n  setIssues(issues: Issue[] | null): void {\n    let issuesBox = this.issuesBox;\n    // @CLEANUP what about event listeners ???\n    issuesBox.innerHTML = '';\n    this.issueComponents = [];\n\n    if (!issues) {\n      // display info message\n      const noIssuesElt = document.createElement('div');\n      noIssuesElt.classList.add('no-issues');\n      noIssuesElt.textContent = `No issues`;\n      issuesBox.appendChild(noIssuesElt);\n      publishResize();\n      return;\n    }\n\n    issues.forEach(issue => {\n      let component = new IssueComponent(issue, this._user);\n      issuesBox.appendChild(component.element);\n      this.issueComponents.push(component);\n    });\n\n    publishResize();\n  }\n}\n\n","import { pageAttributes as page } from './page-attributes';\r\nimport {\r\n  User,\r\n  Issue,\r\n  setRepoContext,\r\n  loadUser,\r\n  loadIssuesByType\r\n} from './github';\r\nimport { FeedbackComponent } from './feedback-component';\r\nimport { setHostOrigin, publishResize } from './bus';\r\n\r\nsetRepoContext(page);\r\n\r\nPromise.all([loadUser(), loadIssuesByType(page.issueTerm as string, \"open\"), loadIssuesByType(page.issueTerm as string, \"closed\")])\r\n  .then(([user, openIssues, closedIssues]) => bootstrap(user, openIssues, closedIssues));\r\n\r\nfunction bootstrap(user: User | null, openIssues: Issue[] | null, closedIssues: Issue[] | null) {\r\n  setHostOrigin(page.origin);\r\n\r\n  const feedback = new FeedbackComponent(user, openIssues, closedIssues);\r\n  document.body.appendChild(feedback.element);\r\n  publishResize();\r\n}\r\n\r\naddEventListener('not-installed', function handleNotInstalled() {\r\n  removeEventListener('not-installed', handleNotInstalled);\r\n  document.querySelector('.timeline')!.insertAdjacentHTML('afterbegin', `\r\n  <div class=\"flash flash-error flash-not-installed\">\r\n    Error: utterances is not installed on <code>${page.owner}/${page.repo}</code>.\r\n    If you own this repo,\r\n    <a href=\"https://github.com/apps/utterances\" target=\"_blank\"><strong>install the app</strong></a>.\r\n    Read more about this change in\r\n    <a href=\"https://github.com/utterance/utterances/pull/25\" target=\"_blank\">the PR</a>.\r\n  </div>`);\r\n});\r\n"]}